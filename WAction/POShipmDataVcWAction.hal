
global
procedure POShipmDataSumup(record POShipmDataVc POSDr)
begin
  row POShipmDataVc POSDrw;
  integer i;
  
  POSDr.Total = 0;
  for (i=0;i<MatRowCnt(POSDr);i=i+1) begin
    MatRowGet(POSDr,i,POSDrw);
    POSDr.Total = POSDr.Total + POSDrw.BalPay;
  end;
  
  return;
end;

function Boolean POShipmDataDClassBalPayEFAfter(Integer wn,Integer rownr,Boolean changedf)
BEGIN
  record POShipmDataVc POSDr;
  
  if (changedf) then begin
    GetWindowRecord(wn,POSDr);   
    if (rownr>=0) then begin
      POShipmDataSumup(POSDr);
    end; 
    PutWindowRecord(wn,POSDr);   
  end;
  POShipmDataDClassBalPayEFAfter = true;
  return;
end;

global
function Boolean POShipmDataDClassAfterEditField(Integer wn,string fieldname,Integer fn, Integer rownr,Integer changed)
BEGIN
  Boolean res;
  switch (fieldname) begin
    case "BalPay": res = POShipmDataDClassBalPayEFAfter(wn,rownr,changed);
  end;
  POShipmDataDClassAfterEditField = res;
  RETURN;
END;

global
function Boolean POShipmDataDClassOnOverStrike(Integer wn,Integer rownr)
begin
  record POShipmDataVc POSDr;

  if (rownr>=0) then begin
    GetWindowRecord(wn,POSDr);    
    POShipmDataSumup(POSDr);
    PutWindowRecord(wn,POSDr);    
  end;
  POShipmDataDClassOnOverStrike = true;
  return;
end;

global
procedure POShipmDataDClassButtonFlags(Integer wn,var Boolean duplOK,var Boolean newOK,var Boolean saveOK,var Boolean restOK)
begin
  duplOK = false;
  newOK = false;
  saveOK = true;
  restOK = true;

  return;
end;

global
function Boolean POShipmDataDClassOnClose(Integer wn,Integer wn2)
begin
  
  DeselectWindow(MotherWindow(wn),false);
  
  POShipmDataDClassOnClose = false;
  return;
end;