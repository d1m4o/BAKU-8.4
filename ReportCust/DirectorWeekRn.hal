//server-only
external procedure FindNLAccBal(string,string,string,Integer,Date,Date,Integer,Integer,Boolean,string,Integer,string,string,var val);
external procedure YcToStr(Integer,var string);
external function Boolean CorspTRTest(record TRVc,record AccVc,Integer,var val,var val);
external procedure ReadCorspTRRowSums(record TRVc,record AccVc,record AccVc,var val,var val,string);
external procedure GetObjs(string,string,var string);
external procedure GetFullCurncyRate(var string,Date,var val,var val,var val,var val,var val);
external function string 200 ValToMyString(val,integer);
external function boolean CompanyIsJWLikeCompany(Integer);
external function Integer InString2(string,string);
external function val AbsoluteVal(val);

SetLangMode(LangRussian,"RUS",0);

procedure OutMyString(integer p1,integer p2,val str,boolean alight)
begin
	if(str!=0)then begin
		outstring(p1,p2,str,alight);
	end else begin
		outstring(p1,p2,"",alight);
	end;
  return;
end;

global
procedure DirectorWeekRn(record RcVc RepSpec)
begin
  record MainVc mainr;
	record TRVc TRr;
	row TRVc TRrw,TR2rw;
  
  record DWTRVc DWTRr,DWTR2r;
  row DWTRVc DWTRrw,DWTR2rw;
  
	record ObjVc Objr;
	record IVVc IVr;
	record IPVc IPr;
	record CLInVc CLInr;
	row CLInVc CLInrw;
	record CLOutVc CLOutr;
	row CLOutVc CLOutrw;
	record CurncyCodeVc CCr;
	record AccVc Accr50,Accr58,Accr59,Accr591,Accr592,Accr4403,Accr51,Accr52,Accr8403,Accr76,Accr7505,Accr53,Accr601;
	array string 5 CurList;
	integer i,j,k,l,rwcnt,rwcnt2,curi;
	boolean TrHs,testf,done,f;
	Date tempDate;
  vector val v;
  val fr,to1EUR,to1USD,to2,br1,br2,tempBal,corspcredval,corspdebval;
	string 20 store,store2;
	array integer tab,headtab;
  array boolean tabprintf;
	integer step;
	string 5 tempStr;
	string 200 tempComm;
	boolean jewlf,njewlf,cretivef,prihodprntdf,rashodprntdf,ksdacheprntdf;
  roundmode rnd;
  
  rnd = DefaultCurRoundoff;
  rnd.decimals = 0;
  rnd.step = kRoundingStepNone;
  rnd.mode = kRoundingModeHalfDown;
  
	v["BeginBalance50"] = 0;
	v["BeginBalance51"] = 0;
	v["BeginBalance53"] = 0;
	v["BeginBalance50n51"] = 0;
	v["BeginBalance50n51n53"] = 0;
	v["BeginBalance50AZN"] = 0;
	v["BeginBalance50USD"] = 0;
	v["BeginBalance50EUR"] = 0;
	v["BeginBalance53AZN"] = 0;
	v["BeginBalance53USD"] = 0;
	v["BeginBalance53EUR"] = 0;
	tempBal = 0;
	v["BalItem1"] = 0;
	v["BalItem2"] = 0;
	v["SaldoEndPeriod53"] = 0;
	v["SaldoEndPeriod53AZN"] = 0;
	v["SaldoEndPeriod53USD"] = 0;
	v["SaldoEndPeriod53EUR"] = 0;
	v["SaldoEndPeriod50n51"] = 0;
	v["SaldoEndPeriod51"] = 0;
	v["SaldoEndPeriod50USD"] = 0;
	v["SaldoEndPeriod50EUR"] = 0;
	v["SaldoEndPeriod50AZN"] = 0;
	corspdebval = blankval;
	corspcredval = blankval;
	v["handed53"] = 0;
	v["kursovaya"] = 0;
	v["convtotal1"] = 0;
	v["convtotal2"] = 0;
	v["convtotal3"] = 0;
	v["convtotal4"] = 0;
	v["convtotal5"] = 0;
  v["AZN52Deb"] = 0;
  v["EUR52Deb"] = 0;
  v["USD52Deb"] = 0;
  v["AZN52Conv"] = 0;
  v["EUR52Conv"] = 0;
  v["USD52Conv"] = 0;
  v["AZN52Cred"] = 0;
  v["EUR52Cred"] = 0;
  v["USD52Cred"] = 0;
  prihodprntdf = false;
  rashodprntdf = false;
  ksdacheprntdf = false;
	if (CompanyIsJWLikeCompany(CurrentCompany)) then begin
	  jewlf = true;
    njewlf = false;
	end else begin
	  jewlf = false;
    njewlf = true;
	end;
  //Edit-------------------Vitalii 16:26 09.03.2018
  jewlf = true;
  njewlf = false;
  if (CurrentCompany==9) then begin
    cretivef = true;
  end else begin
    cretivef = false;
  end;
	curi = 0;
	while(loopmain(CCr,1,true)) begin
		CurList[curi] = CCr.CurncyCode;
		curi = curi + 1;
	end;
	
	Accr50.AccNumber = "50";
	ReadFirstMain(Accr50,1,true);
	Accr51.AccNumber = "51";
	ReadFirstMain(Accr51,1,true);
  Accr52.AccNumber = "52";
	ReadFirstMain(Accr52,1,true);
	Accr58.AccNumber = "58";
	ReadFirstMain(Accr58,1,true);
  Accr59.AccNumber = "59";
	ReadFirstMain(Accr59,1,true);
  Accr591.AccNumber = "59/1";
	ReadFirstMain(Accr591,1,true);
  Accr592.AccNumber = "59/2";
	ReadFirstMain(Accr592,1,true);
	Accr4403.AccNumber = "44/03";
	ReadFirstMain(Accr4403,1,true);
	Accr8403.AccNumber = "84/03";
	ReadFirstMain(Accr8403,1,true);
	Accr76.AccNumber = "76";
	ReadFirstMain(Accr76,1,true);
	Accr7505.AccNumber = "75/05";
	ReadFirstMain(Accr7505,1,true);
	Accr53.AccNumber = "53";
	ReadFirstMain(Accr53,1,true);
	Accr601.AccNumber = "60/1";
	ReadFirstMain(Accr601,1,true);
	
	mainr.AccNumber = "50";
	mainr.TransDate = RepSpec.sStartDate;
	TrHs = true;
	while (LoopMain(mainr,2,TrHs)) begin
		if ((mainr.AccNumber != "50") or (mainr.TransDate > RepSpec.sEndDate))  then begin
			TrHs = false;
		end;
		if (TrHs) then begin
			TRr.Number = mainr.TransNr;
			TRr.IntYc = mainr.IntYc;
			if (ReadFirstMain(TRr,2,true)) then begin
				if (mainr.TransDate == TRr.TransDate) then begin
					rwcnt = MatRowCnt(TRr);
					switch (TRr.IntYc) begin
            case IVYc:
              IVr.SerNr = TRr.Number;
              if (ReadFirstMain(IVr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case IPYc:
              IPr.SerNr = TRr.Number;
              if (ReadFirstMain(IPr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLInYc:
              CLInr.SerNr = TRr.Number;
              if (ReadFirstMain(CLInr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLOutYc:
              CLOutr.SerNr = TRr.Number;
              if (ReadFirstMain(CLOutr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
          end;
          for (i=0;i<rwcnt;i=i+1) begin
						MatRowGet(TRr,i,TRrw);
						done = false;
						if ((TRrw.AccNumber == "50") and (TRrw.ovst <> 1) and SetInSet(RepSpec.ObjStr,TRrw.Objects)) then begin
							switch (TRr.IntYc) begin
								case IVYc:
									if (f) then begin
										DWTRrw.Comment = "СЧ/КЛ." & IVr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case IPYc:
									if (f) then begin
										DWTRrw.Comment = "ПЛ/КЛ." & IPr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case CLInYc:
									if (f) then begin
										DWTRrw.Comment = "ПКО." & CLInr.SerNr;
										rwcnt2 = MatRowCnt(CLInr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLInr,k,CLInrw);
											if nonblank(CLInrw.Comment) and (CLInrw.Comment!="") and (((CLInrw.Sum == TRrw.CurDebVal) or (CLInrw.Sum == -TRrw.CurCredVal)) and ((nonblank(CLInrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLInrw.Objects,TRrw.Objects)) or (blank(CLInrw.Objects)))) then begin
												DWTRrw.ExtraComment = CLInrw.Comment;
                        CLInrw.Comment = "";
                        matrowput(CLInr,k,CLInrw);
                        k = rwcnt2;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLInr.CorspComment;
										end;
									end;
								case CLOutYc:
									if (f) then begin
										DWTRrw.Comment = "РКО." & CLOutr.SerNr;
										rwcnt2 = MatRowCnt(CLOutr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLOutr,k,CLOutrw);
											if nonblank(CLOutrw.Comment) and (CLOutrw.Comment!="") and (((CLOutrw.Sum == TRrw.CurCredVal) or (CLOutrw.Sum == -TRrw.CurDebVal)) and ((nonblank(CLOutrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLOutrw.Objects,TRrw.Objects)) or (blank(CLOutrw.Objects)))) then begin
												DWTRrw.ExtraComment = CLOutrw.Comment;
                        CLOutrw.Comment = "";
                        matrowput(CLOutr,k,CLOutrw);
                        k = rwcnt2;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLOutr.CorspComment;
										end;
									end;
								otherwise
									YcToStr(TRr.IntYc,tempStr);
									DWTRrw.Comment = tempStr & "." & TRr.Number;
									DWTRrw.ExtraComment = TRr.Comment;
							end;
							DWTRrw.ReconDate = mainr.TransDate;	//в столбик Дата
							DWTRrw.Curncy = TRrw.Curncy;			//валюта
							DWTRrw.CurDebVal = TRrw.CurDebVal;	//в столбики Поступления AZN/EUR/USD
							DWTRrw.CurCredVal = TRrw.CurCredVal;	//в столбики Расходы AZN/EUR/USD
							DWTRrw.DebVal = TRrw.DebVal;			//в столбик ПЛ/КЛоступления В осн. валюте
							DWTRrw.CredVal = TRrw.CredVal;		//в столбик Расходы В осн. валюте
							if ((TRr.IntYc == IVYc) and (TRrw.CredVal <> 0)) then begin
								DWTRrw.CurDebVal = - TRrw.CurCredVal;
								DWTRrw.CurCredVal = - TRrw.CurDebVal;
								DWTRrw.DebVal = - TRrw.CredVal;
								DWTRrw.CredVal = - TRrw.DebVal;
							end;
							
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr58,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "58") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.CurCredVal = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.CurCredVal = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    DWTRrw.MyVal1 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.CurDebVal = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
							
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr59,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "59") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.CurCredVal = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.CurCredVal = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    DWTRrw.MyVal1 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.CurDebVal = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
              
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr591,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "59/1") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.CurCredVal = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.CurCredVal = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    DWTRrw.MyVal1 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.CurDebVal = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr592,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "59/2") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.CurCredVal = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.CurCredVal = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    DWTRrw.MyVal1 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.CurDebVal = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr50,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 11:01:28
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								store = "";
								GetObjs("STORE",TRrw.Objects,store);
								for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if (TR2rw.AccNumber == "50") and (TR2rw.ovst <> 1) then begin 
										if ((TR2rw.CredVal == TRrw.DebVal) and (TR2rw.DebVal == TRrw.CredVal)) then begin
											store2 = "";
											GetObjs("STORE",TR2rw.Objects,store2);
											if ((store == store2) and nonblank(store) and nonblank(store2)) or (blank(store) and blank(store2)) then begin
												if (TRrw.CredVal!=0) then begin
													DWTRrw.MyVal1 = -TRrw.CurCredVal;
													DWTRrw.MyVal2 = -TRrw.CredVal;
												end else begin
													DWTRrw.MyVal1 = TRrw.CurDebVal;
													DWTRrw.MyVal2 = TRrw.DebVal;
												end;
												DWTRrw.CurDebVal = blankval;
												DWTRrw.DebVal = blankval;
												DWTRrw.CurCredVal = blankval;
												DWTRrw.CredVal = blankval;
											end else begin
												if (TRrw.DebVal!=0) then begin
													TRrw.CredVal = -TRrw.DebVal;
													TRrw.DebVal = blankval;
													TRrw.CurCredVal = -TRrw.CurDebVal;
													TRrw.CurDebVal = blankval;
												end;
												DWTRrw.CurDebVal = TRrw.CurDebVal;
												DWTRrw.CurCredVal = TRrw.CurCredVal;
												DWTRrw.DebVal = TRrw.DebVal;
												DWTRrw.CredVal = TRrw.CredVal;
											end;
										end else begin
											if i != k then begin
												if ((TR2rw.CredVal == TRrw.DebVal) or (TR2rw.DebVal == TRrw.CredVal)) and (TR2rw.Objects == TRrw.Objects) then begin
													testf = CorspTRTest(TRr,Accr8403,k,corspdebval,corspcredval);
													if testf then begin
														if (TRrw.CredVal!=0) then begin
															DWTRrw.MyVal1 = -TRrw.CurCredVal;
															DWTRrw.MyVal2 = -TRrw.CredVal;
														end else begin
															DWTRrw.MyVal1 = TRrw.CurDebVal;
															DWTRrw.MyVal2 = TRrw.DebVal;
														end;
														DWTRrw.CurDebVal = blankval;
														DWTRrw.DebVal = blankval;
														DWTRrw.CurCredVal = blankval;
														DWTRrw.CredVal = blankval;
													end;
												end;
											end;
										end;
									end;
								end;
							end;
							testf = CorspTRTest(TRr,Accr51,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							testf = CorspTRTest(TRr,Accr8403,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.MyVal3 = - corspdebval + corspcredval;
								v["kursovaya"] = v["kursovaya"] - corspdebval + corspcredval;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              testf = CorspTRTest(TRr,Accr52,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							testf = CorspTRTest(TRr,Accr76,i,corspdebval,corspcredval);//Edit-------------------Vitalii 14:48 28.08.2015
							if (testf and (SetInSet("E131",TRrw.Objects) or SetInSet("E98",TRrw.Objects))) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								if SetInSet("E131",TRrw.Objects) then begin
									v["BalItem1"] = v["BalItem1"] - TRrw.CredVal + TRrw.DebVal;
								end;
								if SetInSet("E98",TRrw.Objects) then begin
									v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              testf = CorspTRTest(TRr,Accr601,i,corspdebval,corspcredval);//Edit-------------------Vitalii 14:48 28.08.2015
							if (testf) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
							testf = CorspTRTest(TRr,Accr7505,i,corspdebval,corspcredval);
							if (testf) then begin
								if (TRrw.DebVal!=0) then begin
									TRrw.CredVal = -TRrw.DebVal;
									TRrw.DebVal = blankval;
									TRrw.CurCredVal = -TRrw.CurDebVal;
									TRrw.CurDebVal = blankval;
									DWTRrw.CurDebVal = TRrw.CurDebVal;
									DWTRrw.CurCredVal = TRrw.CurCredVal;
									DWTRrw.DebVal = TRrw.DebVal;
									DWTRrw.CredVal = TRrw.CredVal;
								end;
							end;
							testf = CorspTRTest(TRr,Accr53,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								v["handed53"] = v["handed53"] + TRrw.CredVal;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							if (!done) then begin
								if ((RepSpec.ArtMode == 1) and (TRr.IntYc == IVYc) and nonblank(TRrw.DebVal)) then begin
									MatRowPut(DWTR2r,l,DWTRrw);
									l = l + 1;
								end else begin
									MatRowPut(DWTRr,j,DWTRrw);
									j = j + 1;
								end;
							end;
              DWTRrw.ReconDate = "";
							DWTRrw.Curncy = "";
							DWTRrw.CurDebVal = blankval;
							DWTRrw.CurCredVal = blankval;
							DWTRrw.DebVal = blankval;
							DWTRrw.CredVal = blankval;
							DWTRrw.MyVal1 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal2 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal3 = blankval;
							DWTRrw.Comment = "";
							DWTRrw.ExtraComment = "";
						end;
					end;
				end;
			end;
		end;
	end;
	ResetLoop(mainr);
	mainr.AccNumber = "51";
	mainr.TransDate = RepSpec.sStartDate;
	TrHs = true;
	while (LoopMain(mainr,2,TrHs)) begin
		if ((mainr.AccNumber != "51") or (mainr.TransDate > RepSpec.sEndDate))  then begin
			TrHs = false;	
		end;
		if (TrHs) then begin
			TRr.Number = mainr.TransNr;
			TRr.IntYc = mainr.IntYc;
			if (ReadFirstMain(TRr,2,true)) then begin
				if (mainr.TransDate == TRr.TransDate) then begin
					rwcnt = MatRowCnt(TRr);
          switch (TRr.IntYc) begin
            case IVYc:
              IVr.SerNr = TRr.Number;
              if (ReadFirstMain(IVr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case IPYc:
              IPr.SerNr = TRr.Number;
              if (ReadFirstMain(IPr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLInYc:
              CLInr.SerNr = TRr.Number;
              if (ReadFirstMain(CLInr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLOutYc:
              CLOutr.SerNr = TRr.Number;
              if (ReadFirstMain(CLOutr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
          end;
					for (i=0;i<rwcnt;i=i+1) begin
						MatRowGet(TRr,i,TRrw);
						if ((TRrw.AccNumber == "51") and (TRrw.ovst <> 1) and SetInSet(RepSpec.ObjStr,TRrw.Objects)) then begin
							switch (TRr.IntYc) begin
								case IVYc:
									if (f) then begin
										DWTRrw.Comment = "СЧ/КЛ." & IVr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case IPYc:
									if (f) then begin
										DWTRrw.Comment = "ПЛ/КЛ." & IPr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case CLInYc:
									if (f) then begin
										DWTRrw.Comment = "ПКО." & CLInr.SerNr;
										rwcnt2 = MatRowCnt(CLInr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLInr,k,CLInrw);
											if nonblank(CLInrw.Comment) and (CLInrw.Comment!="") and (((CLInrw.Sum == AbsoluteVal(TRrw.CurDebVal)) or (CLInrw.Sum == AbsoluteVal(TRrw.CurCredVal))) and ((nonblank(CLInrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLInrw.Objects,TRrw.Objects)) or (blank(CLInrw.Objects)))) then begin
												DWTRrw.ExtraComment = CLInrw.Comment;
                        CLInrw.Comment = "";
                        matrowput(CLInr,k,CLInrw);
                        k = rwcnt2;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLInr.CorspComment;
										end;
									end;
								case CLOutYc:
									if (f) then begin
										DWTRrw.Comment = "РКО." & CLOutr.SerNr;
										rwcnt2 = MatRowCnt(CLOutr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLOutr,k,CLOutrw);
                    	if nonblank(CLOutrw.Comment) and (CLOutrw.Comment!="") and (((AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurCredVal)) or (AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurDebVal))) and ((nonblank(CLOutrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLOutrw.Objects,TRrw.Objects)) or (blank(CLOutrw.Objects)))) then begin
												DWTRrw.ExtraComment = CLOutrw.Comment;
                        CLOutrw.Comment = "";
                        matrowput(CLOutr,k,CLOutrw);
                        k = rwcnt2;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLOutr.CorspComment;
										end;
									end;
								otherwise
									YcToStr(TRr.IntYc,tempStr);
									DWTRrw.Comment = tempStr & "." & TRr.Number;
									DWTRrw.ExtraComment = TRr.Comment;
							end;
							DWTRrw.ReconDate = mainr.TransDate;
							DWTRrw.Curncy = "TER";				//валюта
							DWTRrw.CurDebVal = TRrw.DebVal;		//в столбики Поступления AZN терминал
							DWTRrw.CurCredVal = TRrw.CredVal;		//в столбики Расходы AZN терминал
							DWTRrw.DebVal = TRrw.DebVal;
							DWTRrw.CredVal = TRrw.CredVal;
							
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr50,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr601,i,corspdebval,corspcredval);//Edit-------------------Vitalii 11:15 16.02.2016
							if (testf) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr76,i,corspdebval,corspcredval);//Edit-------------------Vitalii 14:48 28.08.2015
							if (testf and (SetInSet("E131",TRrw.Objects) or SetInSet("E98",TRrw.Objects))) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								if SetInSet("E131",TRrw.Objects) then begin
									v["BalItem1"] = v["BalItem1"] - TRrw.CredVal + TRrw.DebVal;
								end;
								if SetInSet("E98",TRrw.Objects) then begin
									v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr51,i,corspdebval,corspcredval);
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								store = "";
								GetObjs("STORE",TRrw.Objects,store);
								if nonblank(store) then begin
									for (k=0;k<rwcnt;k=k+1) begin
										MatRowGet(TRr,k,TR2rw);
										if (TR2rw.AccNumber == "51") and (TR2rw.ovst <> 1) then begin 
											if ((TR2rw.CredVal == TRrw.DebVal) and (TR2rw.DebVal == TRrw.CredVal)) then begin
												store2 = "";
												GetObjs("STORE",TR2rw.Objects,store2);
												if (store == store2) then begin
													if (TRrw.CredVal!=0) then begin
														DWTRrw.MyVal1 = -TRrw.CredVal;
														DWTRrw.MyVal2 = -TRrw.CredVal;
													end else begin
														DWTRrw.MyVal1 = TRrw.DebVal;
														DWTRrw.MyVal2 = TRrw.DebVal;
													end;
													DWTRrw.CurDebVal = blankval;
													DWTRrw.DebVal = blankval;
													DWTRrw.CurCredVal = blankval;
													DWTRrw.CredVal = blankval;
												end else begin
													if (TRrw.DebVal!=0) then begin
														TRrw.CredVal = -TRrw.DebVal;
														TRrw.DebVal = blankval;
														TRrw.CurCredVal = -TRrw.DebVal;
														TRrw.CurDebVal = blankval;
													end;
													DWTRrw.CurDebVal = TRrw.DebVal;
													DWTRrw.CurCredVal = TRrw.CredVal;
													DWTRrw.DebVal = TRrw.DebVal;
													DWTRrw.CredVal = TRrw.CredVal;
												end;
											end else begin
												if i != k then begin
													if ((TR2rw.CredVal == TRrw.DebVal) or (TR2rw.DebVal == TRrw.CredVal)) and (TR2rw.Objects == TRrw.Objects) then begin
														testf = CorspTRTest(TRr,Accr8403,k,corspdebval,corspcredval);
														if testf then begin
															if (TRrw.CredVal!=0) then begin
																DWTRrw.MyVal1 = -TRrw.CurCredVal;
																DWTRrw.MyVal2 = -TRrw.CredVal;
															end else begin
																DWTRrw.MyVal1 = TRrw.CurDebVal;
																DWTRrw.MyVal2 = TRrw.DebVal;
															end;
															DWTRrw.CurDebVal = blankval;
															DWTRrw.DebVal = blankval;
															DWTRrw.CurCredVal = blankval;
															DWTRrw.CredVal = blankval;
														end;
													end;
												end;
											end;
										end;
									end;
								end;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr52,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
              testf = CorspTRTest(TRr,Accr8403,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal1 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal1 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.MyVal3 = - corspdebval + corspcredval;
								v["kursovaya"] = v["kursovaya"] - corspdebval + corspcredval;
								DWTRrw.CurDebVal = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.CurCredVal = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							if ((RepSpec.ArtMode == 1) and (TRr.IntYc == IVYc) and nonblank(TRrw.DebVal)) then begin
								MatRowPut(DWTR2r,l,DWTRrw);
								l = l + 1;
							end else begin
								MatRowPut(DWTRr,j,DWTRrw);
								j = j + 1;
							end;
              DWTRrw.ReconDate = "";
							DWTRrw.Curncy = "";
							DWTRrw.CurDebVal = blankval;
							DWTRrw.CurCredVal = blankval;
							DWTRrw.DebVal = blankval;
							DWTRrw.CredVal = blankval;
							DWTRrw.MyVal1 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal2 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
              DWTRrw.MyVal3 = blankval;
							DWTRrw.Comment = "";
							DWTRrw.ExtraComment = "";
						end;
					end;
				end;
			end;
		end;
	end;
	ResetLoop(mainr);
	mainr.AccNumber = "53";
	mainr.TransDate = RepSpec.sStartDate;
	TrHs = true;
	while (LoopMain(mainr,2,TrHs)) begin
		if ((mainr.AccNumber != "53") or (mainr.TransDate > RepSpec.sEndDate))  then begin
			TrHs = false;
		end;
		if (TrHs) then begin
			TRr.Number = mainr.TransNr;
			TRr.IntYc = mainr.IntYc;
			if (ReadFirstMain(TRr,2,true)) then begin
				if (mainr.TransDate == TRr.TransDate) then begin
					rwcnt = MatRowCnt(TRr);
          switch (TRr.IntYc) begin
            case IVYc:
              IVr.SerNr = TRr.Number;
              if (ReadFirstMain(IVr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case IPYc:
              IPr.SerNr = TRr.Number;
              if (ReadFirstMain(IPr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLInYc:
              CLInr.SerNr = TRr.Number;
              if (ReadFirstMain(CLInr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLOutYc:
              CLOutr.SerNr = TRr.Number;
              if (ReadFirstMain(CLOutr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
          end;
					for (i=0;i<rwcnt;i=i+1) begin
						MatRowGet(TRr,i,TRrw);
						done = false;
						if ((TRrw.AccNumber == "53") and (TRrw.ovst <> 1) and SetInSet(RepSpec.ObjStr,TRrw.Objects)) then begin
							switch (TRr.IntYc) begin
								case IVYc:
									if (f) then begin
										DWTRrw.Comment = "СЧ/КЛ." & IVr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case IPYc:
									if (f) then begin
										DWTRrw.Comment = "ПЛ/КЛ." & IPr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case CLInYc:
									if (f) then begin
										DWTRrw.Comment = "ПКО." & CLInr.SerNr;
										rwcnt2 = MatRowCnt(CLInr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLInr,k,CLInrw);
											if nonblank(CLInrw.Comment) and (CLInrw.Comment!="") and (((CLInrw.Sum == AbsoluteVal(TRrw.CurDebVal)) or (CLInrw.Sum == AbsoluteVal(TRrw.CurCredVal))) and ((nonblank(CLInrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLInrw.Objects,TRrw.Objects)) or (blank(CLInrw.Objects)))) then begin
												DWTRrw.ExtraComment = CLInrw.Comment;
                        CLInrw.Comment = "";
                        matrowput(CLInr,k,CLInrw);
                        k = rwcnt2;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLInr.CorspComment;
										end;
									end;
								case CLOutYc:
									if (f) then begin
										DWTRrw.Comment = "РКО." & CLOutr.SerNr;
										rwcnt2 = MatRowCnt(CLOutr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLOutr,k,CLOutrw);
                    	if nonblank(CLOutrw.Comment) and (CLOutrw.Comment!="") and (((AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurCredVal)) or (AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurDebVal))) and ((nonblank(CLOutrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLOutrw.Objects,TRrw.Objects)) or (blank(CLOutrw.Objects)))) then begin
												DWTRrw.ExtraComment = CLOutrw.Comment;
                        CLOutrw.Comment = "";
                        matrowput(CLOutr,k,CLOutrw);
                        k = rwcnt2;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLOutr.CorspComment;
										end;
									end;
								otherwise
									YcToStr(TRr.IntYc,tempStr);
									DWTRrw.Comment = tempStr & "." & TRr.Number;
									DWTRrw.ExtraComment = TRr.Comment;
							end;
							DWTRrw.ReconDate = mainr.TransDate;
							DWTRrw.Curncy = TRrw.Curncy;				//валюта
							DWTRrw.MyVal16 = TRrw.CurDebVal;		//в столбики Поступления AZN 
							DWTRrw.MyVal17 = TRrw.CurCredVal;		//в столбики Расходы AZN 
							DWTRrw.DebVal = TRrw.DebVal;        //в столбики Поступления AZN осн
							DWTRrw.CredVal = TRrw.CredVal;      //в столбики Расходы AZN осн
              if ((TRr.IntYc == IVYc) and (TRrw.CredVal <> 0)) then begin
								DWTRrw.MyVal16 = - TRrw.CurCredVal;
								DWTRrw.MyVal17 = - TRrw.CurDebVal;
								DWTRrw.DebVal = - TRrw.CredVal;
								DWTRrw.CredVal = - TRrw.DebVal;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr50,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal18 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal18 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.MyVal16 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal17 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr51,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal18 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal18 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.MyVal16 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal17 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              corspdebval = blankval;
							corspcredval = blankval;
              testf = CorspTRTest(TRr,Accr52,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal18 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal18 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                DWTRrw.MyVal16 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal17 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr53,i,corspdebval,corspcredval);
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								store = "";
								GetObjs("STORE",TRrw.Objects,store);
								if nonblank(store) then begin
									for (k=0;k<rwcnt;k=k+1) begin
										MatRowGet(TRr,k,TR2rw);
										if (TR2rw.AccNumber == "53") and (TR2rw.ovst <> 1) then begin 
											if ((TR2rw.CredVal == TRrw.DebVal) and (TR2rw.DebVal == TRrw.CredVal)) then begin
												store2 = "";
												GetObjs("STORE",TR2rw.Objects,store2);
												if (store == store2) then begin
													if (TRrw.CredVal!=0) then begin
														DWTRrw.MyVal18 = -TRrw.CredVal;
														DWTRrw.MyVal2 = -TRrw.CredVal;
													end else begin
														DWTRrw.MyVal18 = TRrw.DebVal;
														DWTRrw.MyVal2 = TRrw.DebVal;
													end;
													DWTRrw.MyVal16 = blankval;
													DWTRrw.DebVal = blankval;
													DWTRrw.MyVal17 = blankval;
													DWTRrw.CredVal = blankval;
												end else begin
													if (TRrw.DebVal!=0) then begin
														TRrw.CredVal = -TRrw.DebVal;
														TRrw.DebVal = blankval;
														TRrw.CurCredVal = -TRrw.DebVal;
														TRrw.CurDebVal = blankval;
													end;
													DWTRrw.MyVal16 = TRrw.DebVal;
													DWTRrw.MyVal17 = TRrw.CredVal;
													DWTRrw.DebVal = TRrw.DebVal;
													DWTRrw.CredVal = TRrw.CredVal;
												end;
											end else begin
												if i != k then begin
													if ((TR2rw.CredVal == TRrw.DebVal) or (TR2rw.DebVal == TRrw.CredVal)) and (TR2rw.Objects == TRrw.Objects) then begin
														testf = CorspTRTest(TRr,Accr8403,k,corspdebval,corspcredval);
														if testf then begin
															if (TRrw.CredVal!=0) then begin
																DWTRrw.MyVal1 = -TRrw.CurCredVal;
																DWTRrw.MyVal2 = -TRrw.CredVal;
															end else begin
																DWTRrw.MyVal1 = TRrw.CurDebVal;
																DWTRrw.MyVal2 = TRrw.DebVal;
															end;
															DWTRrw.MyVal16 = blankval;
															DWTRrw.DebVal = blankval;
															DWTRrw.MyVal17 = blankval;
															DWTRrw.CredVal = blankval;
														end;
													end;
												end;
											end;
										end;
									end;
								end;
							end;
              corspdebval = blankval;
							corspcredval = blankval;
              testf = CorspTRTest(TRr,Accr8403,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal18 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal18 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
								DWTRrw.MyVal3 = - corspdebval + corspcredval;
								v["kursovaya"] = v["kursovaya"] - corspdebval + corspcredval;
								DWTRrw.MyVal16 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal17 = blankval;
								DWTRrw.CredVal = blankval;
                v["kursovaya53"] = v["kursovaya53"] - corspdebval + corspcredval;
							end;
              
              if (!done) then begin
								if ((RepSpec.ArtMode == 1) and (TRr.IntYc == IVYc) and nonblank(TRrw.DebVal)) then begin
									MatRowPut(DWTR2r,l,DWTRrw);
									l = l + 1;
								end else begin
									MatRowPut(DWTRr,j,DWTRrw);
									j = j + 1;
								end;
							end;
              DWTRrw.ReconDate = "";
							DWTRrw.Curncy = "";
							DWTRrw.CurDebVal = blankval;
							DWTRrw.CurCredVal = blankval;
							DWTRrw.DebVal = blankval;
							DWTRrw.CredVal = blankval;
							DWTRrw.MyVal16 = blankval;
							DWTRrw.MyVal17 = blankval;
							DWTRrw.MyVal18 = blankval;
              DWTRrw.MyVal2 = blankval;
							DWTRrw.Comment = "";
							DWTRrw.ExtraComment = "";
              
              
						end;
					end;
				end;
			end;
		end;
	end;
  
  ResetLoop(mainr);
  mainr.AccNumber = "52";
	mainr.TransDate = RepSpec.sStartDate;
	TrHs = true;
	while (LoopMain(mainr,2,TrHs)) begin
		if ((mainr.AccNumber != "52") or (mainr.TransDate > RepSpec.sEndDate))  then begin
			TrHs = false;
		end;
		if (TrHs) then begin
			TRr.Number = mainr.TransNr;
			TRr.IntYc = mainr.IntYc;
			if (ReadFirstMain(TRr,2,true)) then begin
      	if (mainr.TransDate == TRr.TransDate) then begin
					rwcnt = MatRowCnt(TRr);
					switch (TRr.IntYc) begin
            case IVYc:
              IVr.SerNr = TRr.Number;
              if (ReadFirstMain(IVr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case IPYc:
              IPr.SerNr = TRr.Number;
              if (ReadFirstMain(IPr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLInYc:
              CLInr.SerNr = TRr.Number;
              if (ReadFirstMain(CLInr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
            case CLOutYc:
              CLOutr.SerNr = TRr.Number;
              if (ReadFirstMain(CLOutr,1,true)) then begin
                f = true;
              end else begin
                f = false;
              end;
          end;
          for (i=0;i<rwcnt;i=i+1) begin
						MatRowGet(TRr,i,TRrw);
						done = false;
						if ((TRrw.AccNumber == "52") and (TRrw.ovst <> 1) and SetInSet(RepSpec.ObjStr,TRrw.Objects)) then begin
							switch (TRr.IntYc) begin
								case IVYc:
									if (f) then begin
										DWTRrw.Comment = "СЧ/КЛ." & IVr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case IPYc:
									if (f) then begin
										DWTRrw.Comment = "ПЛ/КЛ." & IPr.SerNr;
										DWTRrw.ExtraComment = TRr.Comment;
									end;
								case CLInYc:
									if (f) then begin
										DWTRrw.Comment = "ПКО." & CLInr.SerNr;
										rwcnt2 = MatRowCnt(CLInr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLInr,k,CLInrw);
											if nonblank(CLInrw.Comment) and (CLInrw.Comment!="") and (((CLInrw.Sum == AbsoluteVal(TRrw.CurDebVal)) or (CLInrw.Sum == AbsoluteVal(TRrw.CurCredVal))) and ((nonblank(CLInrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLInrw.Objects,TRrw.Objects)) or (blank(CLInrw.Objects)))) then begin
												DWTRrw.ExtraComment = CLInrw.Comment;
                        CLInrw.Comment = "";
                        matrowput(CLInr,k,CLInrw);
                        k = rwcnt2;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLInr.CorspComment;
										end;
									end;
								case CLOutYc:
									if (f) then begin
										DWTRrw.Comment = "РКО." & CLOutr.SerNr;
										rwcnt2 = MatRowCnt(CLOutr);
										for (k=0;k<rwcnt2;k=k+1) begin
											MatRowGet(CLOutr,k,CLOutrw);
											if nonblank(CLOutrw.Comment) and (CLOutrw.Comment!="") and (((AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurCredVal)) or (AbsoluteVal(CLOutrw.Sum) == AbsoluteVal(TRrw.CurDebVal))) and ((nonblank(CLOutrw.Objects) and nonblank(TRrw.Objects) and SetInSet(CLOutrw.Objects,TRrw.Objects)) or (blank(CLOutrw.Objects)))) then begin
												DWTRrw.ExtraComment = CLOutrw.Comment;
                        CLOutrw.Comment = "";
                        matrowput(CLOutr,k,CLOutrw);
                        k = rwcnt2;
											end;
										end;
										if blank(DWTRrw.ExtraComment) then begin
											DWTRrw.ExtraComment = CLOutr.CorspComment;
										end;
									end;
								otherwise
									YcToStr(TRr.IntYc,tempStr);
									DWTRrw.Comment = tempStr & "." & TRr.Number;
									DWTRrw.ExtraComment = TRr.Comment;
							end;
							DWTRrw.ReconDate = mainr.TransDate;
							DWTRrw.Curncy = TRrw.Curncy & "52";
							DWTRrw.MyVal7 = TRrw.CurDebVal;
              if (!setinset("7",DWTRrw.TFromCode)) then begin
                DWTRrw.TFromCode = DWTRrw.TFromCode & "7,";
              end;
							DWTRrw.MyVal9 = TRrw.CurCredVal;
              if (!setinset("9",DWTRrw.TFromCode)) then begin
                DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
              end;
							DWTRrw.DebVal = TRrw.DebVal;
							DWTRrw.CredVal = TRrw.CredVal;
							if ((TRr.IntYc == IVYc) and (TRrw.CredVal <> 0)) then begin
								DWTRrw.MyVal7 = - TRrw.CurCredVal;
                if (!setinset("7",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "7,";
                end;
								DWTRrw.MyVal9 = - TRrw.CurDebVal;
                if (!setinset("9",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                end;
								DWTRrw.DebVal = - TRrw.CredVal;
								DWTRrw.CredVal = - TRrw.DebVal;
							end;
							
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr58,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "58") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.MyVal9 = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.MyVal9 = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    if (!setinset("9",DWTRrw.TFromCode)) then begin
                      DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                    end;
                    DWTRrw.MyVal8 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.MyVal7 = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
							
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr59,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "59") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.MyVal9 = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.MyVal9 = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    if (!setinset("9",DWTRrw.TFromCode)) then begin
                      DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                    end;
                    DWTRrw.MyVal8 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.MyVal7 = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
              
							corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr591,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "59/1") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.MyVal9 = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.MyVal9 = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    if (!setinset("9",DWTRrw.TFromCode)) then begin
                      DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                    end;
                    DWTRrw.MyVal8 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.MyVal7 = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr592,i,corspdebval,corspcredval);
							if testf then begin
              	for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if ((TR2rw.AccNumber == "59/2") and (TR2rw.ovst <> 1) and (TR2rw.CredVal==corspcredval) and (TR2rw.DebVal==corspdebval)) then begin
                    if (TR2rw.CredVal!=0) then begin
                      DWTRrw.MyVal9 = -TR2rw.CurCredVal;
                      DWTRrw.CredVal = -TR2rw.CredVal;
                    end else begin
                      DWTRrw.MyVal9 = TR2rw.CurDebVal;
                      DWTRrw.CredVal = TR2rw.DebVal;
                    end;
                    if (!setinset("9",DWTRrw.TFromCode)) then begin
                      DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                    end;
                    DWTRrw.MyVal8 = blankval;
                    DWTRrw.MyVal2 = blankval;
                    DWTRrw.MyVal7 = blankval;
                    DWTRrw.DebVal = blankval;
									end;
								end;
							end;
              
              corspdebval = blankval;
							corspcredval = blankval;
							testf = CorspTRTest(TRr,Accr52,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 11:01:28
							if (testf and (corspdebval==TRrw.CredVal or corspcredval==TRrw.DebVal) and (TRr.IntYc != IVYc) and (TRr.IntYc != IPYc)) then begin
								store = "";
								GetObjs("STORE",TRrw.Objects,store);
								for (k=0;k<rwcnt;k=k+1) begin
									MatRowGet(TRr,k,TR2rw);
									if (TR2rw.AccNumber == "52") and (TR2rw.ovst <> 1) then begin 
										if ((TR2rw.CredVal == TRrw.DebVal) and (TR2rw.DebVal == TRrw.CredVal)) then begin
											store2 = "";
											GetObjs("STORE",TR2rw.Objects,store2);
											if ((store == store2) and nonblank(store) and nonblank(store2)) or (blank(store) and blank(store2)) then begin
												if (TRrw.CredVal!=0) then begin
													DWTRrw.MyVal8 = -TRrw.CurCredVal;
													DWTRrw.MyVal2 = -TRrw.CredVal;
												end else begin
													DWTRrw.MyVal8 = TRrw.CurDebVal;
													DWTRrw.MyVal2 = TRrw.DebVal;
												end;
                        if (!setinset("8",DWTRrw.TFromCode)) then begin
                          DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                        end;
												DWTRrw.MyVal7 = blankval;
												DWTRrw.DebVal = blankval;
												DWTRrw.MyVal9 = blankval;
												DWTRrw.CredVal = blankval;
											end else begin
												if (TRrw.DebVal!=0) then begin
													TRrw.CredVal = -TRrw.DebVal;
													TRrw.DebVal = blankval;
													TRrw.MyVal9 = -TRrw.CurDebVal;
													TRrw.MyVal7 = blankval;
												end;
												DWTRrw.MyVal7 = TRrw.CurDebVal;
                        if (!setinset("7",DWTRrw.TFromCode)) then begin
                          DWTRrw.TFromCode = DWTRrw.TFromCode & "7,";
                        end;
												DWTRrw.MyVal9 = TRrw.CurCredVal;
                        if (!setinset("9",DWTRrw.TFromCode)) then begin
                          DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                        end;
												DWTRrw.DebVal = TRrw.DebVal;
												DWTRrw.CredVal = TRrw.CredVal;
											end;
										end else begin
											if i != k then begin
												if ((TR2rw.CredVal == TRrw.DebVal) or (TR2rw.DebVal == TRrw.CredVal)) and (TR2rw.Objects == TRrw.Objects) then begin
													testf = CorspTRTest(TRr,Accr8403,k,corspdebval,corspcredval);
													if testf then begin
														if (TRrw.CredVal!=0) then begin
															DWTRrw.MyVal8 = -TRrw.CurCredVal;
															DWTRrw.MyVal2 = -TRrw.CredVal;
														end else begin
															DWTRrw.MyVal8 = TRrw.CurDebVal;
															DWTRrw.MyVal2 = TRrw.DebVal;
														end;
                            if (!setinset("8",DWTRrw.TFromCode)) then begin
                              DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                            end;
                            DWTRrw.MyVal7 = blankval;
														DWTRrw.DebVal = blankval;
														DWTRrw.MyVal9 = blankval;
														DWTRrw.CredVal = blankval;
													end;
												end;
											end;
										end;
									end;
								end;
							end;
							testf = CorspTRTest(TRr,Accr51,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
              testf = CorspTRTest(TRr,Accr50,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              testf = CorspTRTest(TRr,Accr8403,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
              	if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                DWTRrw.MyVal3 = - corspdebval + corspcredval;
								v["kursovaya52"] = v["kursovaya52"] - corspdebval + corspcredval;
								DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              /*testf = CorspTRTest(TRr,Accr52,i,corspdebval,corspcredval);// Edit ************************** Wednesday, 26 August 2015 16:05:46
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;*/
							
							testf = CorspTRTest(TRr,Accr76,i,corspdebval,corspcredval);//Edit-------------------Vitalii 14:48 28.08.2015
							if (testf and (SetInSet("E131",TRrw.Objects) or SetInSet("E98",TRrw.Objects))) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
								if SetInSet("E131",TRrw.Objects) then begin
									v["BalItem1"] = v["BalItem1"] - TRrw.CredVal + TRrw.DebVal;
								end;
								if SetInSet("E98",TRrw.Objects) then begin
									v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								end;
								DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
              testf = CorspTRTest(TRr,Accr601,i,corspdebval,corspcredval);//Edit-------------------Vitalii 14:48 28.08.2015
							if (testf) then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
                v["BalItem2"] = v["BalItem2"] + TRrw.CredVal - TRrw.DebVal;
								DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
              
							testf = CorspTRTest(TRr,Accr7505,i,corspdebval,corspcredval);
							if (testf) then begin
								if (TRrw.DebVal!=0) then begin
									TRrw.CredVal = -TRrw.DebVal;
									TRrw.DebVal = blankval;
									TRrw.MyVal9 = -TRrw.CurDebVal;
									TRrw.MyVal7 = blankval;
									DWTRrw.MyVal7 = TRrw.CurDebVal;
                  if (!setinset("7",DWTRrw.TFromCode)) then begin
                    DWTRrw.TFromCode = DWTRrw.TFromCode & "7,";
                  end;
									DWTRrw.MyVal9 = TRrw.CurCredVal;
                  if (!setinset("9",DWTRrw.TFromCode)) then begin
                    DWTRrw.TFromCode = DWTRrw.TFromCode & "9,";
                  end;
									DWTRrw.DebVal = TRrw.DebVal;
									DWTRrw.CredVal = TRrw.CredVal;
								end;
							end;
							testf = CorspTRTest(TRr,Accr53,i,corspdebval,corspcredval);
							if testf then begin
								if(TRrw.CredVal!=0)then begin
									DWTRrw.MyVal8 = -TRrw.CurCredVal;
									DWTRrw.MyVal2 = -TRrw.CredVal;
								end else begin
									DWTRrw.MyVal8 = TRrw.CurDebVal;
									DWTRrw.MyVal2 = TRrw.DebVal;
								end;
                if (!setinset("8",DWTRrw.TFromCode)) then begin
                  DWTRrw.TFromCode = DWTRrw.TFromCode & "8,";
                end;
								v["handed53"] = v["handed53"] + TRrw.CredVal;
								DWTRrw.MyVal7 = blankval;
								DWTRrw.DebVal = blankval;
								DWTRrw.MyVal9 = blankval;
								DWTRrw.CredVal = blankval;
							end;
							
							if (!done) then begin
								if ((RepSpec.ArtMode == 1) and (TRr.IntYc == IVYc) and nonblank(TRrw.DebVal)) then begin
									MatRowPut(DWTR2r,l,DWTRrw);
									l = l + 1;
								end else begin
									MatRowPut(DWTRr,j,DWTRrw);
									j = j + 1;
								end;
							end;
              DWTRrw.ReconDate = "";
							DWTRrw.Curncy = "";
							DWTRrw.MyVal7 = blankval;
							DWTRrw.MyVal9 = blankval;
							DWTRrw.DebVal = blankval;
							DWTRrw.CredVal = blankval;
							DWTRrw.MyVal8 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal2 = blankval;// Edit ************************** Wednesday, 26 August 2015 11:34:24
							DWTRrw.MyVal3 = blankval;
							DWTRrw.Comment = "";
							DWTRrw.ExtraComment = "";
						end;
					end;
				end;
			end;
		end;
	end;
  
  
	rwcnt = MatRowCnt(DWTRr);
	for (i=0;i<rwcnt;i=i+1) begin
		MatRowGet(DWTRr,i,DWTRrw);
		if (right(DWTRrw.Curncy,2)=="52") then begin
      f = true;
    end else begin
      f = false;
    end;
    DWTRrw.Curncy = left(DWTRrw.Curncy,3);
		MatRowPut(DWTRr,i,DWTRrw);
    switch (DWTRrw.Curncy) begin
      case "TER":
        if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[2] = true; end;
        if (DWTRrw.MyVal1!=blankval) then begin tabprintf[13] = true; end;
        if (DWTRrw.CurCredVal!=blankval) then begin tabprintf[25] = true; end;
      case "AZN":
        if (f and (DWTRrw.MyVal7!=blankval)) then begin tabprintf[3] = true; end;
        if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[6] = true; end;
        if (f and (DWTRrw.MyVal8!=blankval)) then begin tabprintf[14] = true; end;
        if (DWTRrw.MyVal1!=blankval) then begin tabprintf[17] = true; end;
        if (f and (DWTRrw.MyVal9!=blankval)) then begin tabprintf[26] = true; end;
        if (DWTRrw.CurCredVal!=blankval) then begin tabprintf[29] = true; end;
        if (DWTRrw.MyVal16!=blankval) then begin tabprintf[9] = true; end;
        if (DWTRrw.MyVal18!=blankval) then begin tabprintf[20] = true; end;
        if (DWTRrw.MyVal17!=blankval) then begin tabprintf[32] = true; end;
      case "EUR":
        if (f and (DWTRrw.MyVal7!=blankval)) then begin tabprintf[4] = true; end;
        if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[7] = true; end;
        if (f and (DWTRrw.MyVal8!=blankval)) then begin tabprintf[15] = true; end;
        if (DWTRrw.MyVal1!=blankval) then begin tabprintf[18] = true; end;
        if (f and (DWTRrw.MyVal9!=blankval)) then begin tabprintf[27] = true; end;
        if (DWTRrw.CurCredVal!=blankval) then begin tabprintf[30] = true; end;
        if (DWTRrw.MyVal16!=blankval) then begin tabprintf[10] = true; end;
        if (DWTRrw.MyVal18!=blankval) then begin tabprintf[21] = true; end;
        if (DWTRrw.MyVal17!=blankval) then begin tabprintf[33] = true; end;
      case "USD":
        if (f and (DWTRrw.MyVal7!=blankval)) then begin tabprintf[5] = true; end;
        if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[8] = true; end;
        if (f and (DWTRrw.MyVal8!=blankval)) then begin tabprintf[16] = true; end;
        if (DWTRrw.MyVal1!=blankval) then begin tabprintf[19] = true; end;
        if (f and (DWTRrw.MyVal9!=blankval)) then begin tabprintf[28] = true; end;
        if (DWTRrw.CurCredVal!=blankval) then begin tabprintf[31] = true; end;
        if (DWTRrw.MyVal16!=blankval) then begin tabprintf[11] = true; end;
        if (DWTRrw.MyVal18!=blankval) then begin tabprintf[22] = true; end;
        if (DWTRrw.MyVal17!=blankval) then begin tabprintf[34] = true; end;
    end;
    if (DWTRrw.DebVal!=blankval) then begin tabprintf[12] = true; end;
    if (DWTRrw.MyVal2!=blankval) then begin tabprintf[23] = true; end;
    if (DWTRrw.MyVal3!=blankval) then begin tabprintf[24] = true; end;
    if (DWTRrw.CredVal!=blankval) then begin tabprintf[35] = true; end;
	end;
	if (RepSpec.ArtMode == 1) then begin
		rwcnt2 = MatRowCnt(DWTR2r);
		for (i=0;i<rwcnt2;i=i+1) begin
			MatRowGet(DWTR2r,i,DWTRrw);
			if (right(DWTRrw.Curncy,2)=="52") then begin
        f = true;
      end else begin
        f = false;
      end;
      DWTRrw.Curncy = left(DWTRrw.Curncy,3);
			MatRowPut(DWTR2r,i,DWTRrw);
      if (f) then begin
        switch (DWTRrw.Curncy) begin
          case "AZN":
            if (DWTRrw.MyVal7!=blankval) then begin tabprintf[3] = true; end;
          case "EUR":
            if (DWTRrw.MyVal7!=blankval) then begin tabprintf[4] = true; end;
          case "USD":
            if (DWTRrw.MyVal7!=blankval) then begin tabprintf[5] = true; end;
        end;
      end;
      switch (DWTRrw.Curncy) begin
        case "TER":
          if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[2] = true; end;
        case "AZN":
          if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[6] = true; end;
          if (DWTRrw.MyVal16!=blankval) then begin tabprintf[9] = true; end;
        case "EUR":
          if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[7] = true; end;
          if (DWTRrw.MyVal16!=blankval) then begin tabprintf[10] = true; end;
        case "USD":
          if (DWTRrw.CurDebVal!=blankval) then begin tabprintf[8] = true; end;
          if (DWTRrw.MyVal16!=blankval) then begin tabprintf[11] = true; end;
      end;
      if (DWTRrw.DebVal!=blankval) then begin tabprintf[12] = true; end;
      if (f) then begin
        switch (DWTRrw.Curncy) begin
          case "AZN":
            if (DWTRrw.MyVal8!=blankval) then begin tabprintf[14] = true; end;
          case "EUR":
            if (DWTRrw.MyVal8!=blankval) then begin tabprintf[15] = true; end;
          case "USD":
            if (DWTRrw.MyVal8!=blankval) then begin tabprintf[16] = true; end;
        end;
      end;
      switch (DWTRrw.Curncy) begin
        case "TER":
          if (DWTRrw.MyVal1!=blankval) then begin tabprintf[13] = true; end;
        case "AZN":
          if (DWTRrw.MyVal1!=blankval) then begin tabprintf[17] = true; end;
          if (DWTRrw.MyVal18!=blankval) then begin tabprintf[20] = true; end;
        case "EUR":
          if (DWTRrw.MyVal1!=blankval) then begin tabprintf[18] = true; end;
          if (DWTRrw.MyVal18!=blankval) then begin tabprintf[21] = true; end;
        case "USD":
          if (DWTRrw.MyVal1!=blankval) then begin tabprintf[19] = true; end;
          if (DWTRrw.MyVal18!=blankval) then begin tabprintf[22] = true; end;
      end;
      if (DWTRrw.MyVal2!=blankval) then begin tabprintf[23] = true; end;
      if (DWTRrw.MyVal3!=blankval) then begin tabprintf[24] = true; end;
		end;
		rwcnt2 = MatRowCnt(DWTR2r);
		for (j=0;j<rwcnt2-1;j=j+1) begin
			for (i=0;i<rwcnt2-1;i=i+1) begin
				MatRowGet(DWTR2r,i,DWTRrw);
				MatRowGet(DWTR2r,i+1,DWTR2rw);
				if (DWTRrw.ReconDate > DWTR2rw.ReconDate) then begin
					MatRowPut(DWTR2r,i,DWTR2rw);
					MatRowPut(DWTR2r,i+1,DWTRrw);
				end;
			end;
		end;
		for (i=0;i<rwcnt2;i=i+1) begin
			MatRowGet(DWTR2r,i,DWTRrw);
      DWTRrw.MyVal6 = DWTRrw.MyVal3;
			switch (DWTRrw.Curncy) begin
				case "TER":
					DWTRrw.NomVal = DWTRrw.CurDebVal;
          DWTRrw.MyVal5 = DWTRrw.MyVal1;
          DWTRrw.MyVal1 = 0;
          DWTRrw.CurDebVal = 0;
				case "AZN":
					DWTRrw.CredVal2 = DWTRrw.CurDebVal;
          DWTRrw.MyVal1 = DWTRrw.MyVal1;
          DWTRrw.MyVal10 = DWTRrw.MyVal7;
          DWTRrw.MyVal13 = DWTRrw.MyVal8;
          if (!setinset("13",DWTRrw.TFromCode)) then begin
            DWTRrw.TFromCode = DWTRrw.TFromCode & "13,";
          end;
          DWTRrw.MyVal7 = 0;
          if (!setinset("7",DWTRrw.TFromCode)) then begin
            j = InString2(DWTRrw.TFromCode,"7");
            DWTRrw.TFromCode = left(DWTRrw.TFromCode,j) & right(DWTRrw.TFromCode,(len(DWTRrw.TFromCode)-j-2));
          end;
          DWTRrw.MyVal8 = 0;
          if (!setinset("8",DWTRrw.TFromCode)) then begin
            j = InString2(DWTRrw.TFromCode,"8");
            DWTRrw.TFromCode = left(DWTRrw.TFromCode,j) & right(DWTRrw.TFromCode,(len(DWTRrw.TFromCode)-j-2));
          end;
          DWTRrw.CurDebVal = 0;
				case "EUR":
					DWTRrw.DebVal2 = DWTRrw.CurDebVal;
          DWTRrw.MyVal11 = DWTRrw.MyVal7;
          DWTRrw.MyVal3 = DWTRrw.MyVal1;
          DWTRrw.MyVal14 = DWTRrw.MyVal8;
          DWTRrw.MyVal1 = 0;
          DWTRrw.MyVal7 = 0;
          if (!setinset("7",DWTRrw.TFromCode)) then begin
            j = InString2(DWTRrw.TFromCode,"7");
            DWTRrw.TFromCode = left(DWTRrw.TFromCode,j) & right(DWTRrw.TFromCode,(len(DWTRrw.TFromCode)-j-2));
          end;
          DWTRrw.MyVal8 = 0;
          if (!setinset("8",DWTRrw.TFromCode)) then begin
            j = InString2(DWTRrw.TFromCode,"8");
            DWTRrw.TFromCode = left(DWTRrw.TFromCode,j) & right(DWTRrw.TFromCode,(len(DWTRrw.TFromCode)-j-2));
          end;
          DWTRrw.CurDebVal = 0;
				case "USD":
					DWTRrw.Qty = DWTRrw.CurDebVal;
          DWTRrw.MyVal4 = DWTRrw.MyVal1;
          DWTRrw.MyVal12 = DWTRrw.MyVal7;
          DWTRrw.MyVal15 = DWTRrw.MyVal8;
          DWTRrw.MyVal1 = 0;
          DWTRrw.MyVal7 = 0;
          if (!setinset("7",DWTRrw.TFromCode)) then begin
            j = InString2(DWTRrw.TFromCode,"7");
            DWTRrw.TFromCode = left(DWTRrw.TFromCode,j) & right(DWTRrw.TFromCode,(len(DWTRrw.TFromCode)-j-2));
          end;
          DWTRrw.MyVal8 = 0;
          if (!setinset("8",DWTRrw.TFromCode)) then begin
            j = InString2(DWTRrw.TFromCode,"8");
            DWTRrw.TFromCode = left(DWTRrw.TFromCode,j) & right(DWTRrw.TFromCode,(len(DWTRrw.TFromCode)-j-2));
          end;
          DWTRrw.CurDebVal = 0;
			end;
			MatRowPut(DWTR2r,i,DWTRrw);
		end;
		for (j=0;j<rwcnt2-1;j=j+1) begin
			MatRowGet(DWTR2r,j,DWTRrw);
			for (i=j + 1;i<rwcnt2;i=i+1) begin
				MatRowGet(DWTR2r,i,DWTR2rw);
				if (DWTRrw.ReconDate == DWTR2rw.ReconDate) then begin
					DWTRrw.CredVal2 = DWTRrw.CredVal2 + DWTR2rw.CredVal2;
					DWTRrw.DebVal2 = DWTRrw.DebVal2 + DWTR2rw.DebVal2;
					DWTRrw.Qty = DWTRrw.Qty + DWTR2rw.Qty;
					DWTRrw.NomVal = DWTRrw.NomVal + DWTR2rw.NomVal;
					DWTRrw.DebVal = DWTRrw.DebVal + DWTR2rw.DebVal;
					DWTRrw.MyVal1 = DWTRrw.MyVal1 + DWTR2rw.MyVal1;
          DWTRrw.MyVal2 = DWTRrw.MyVal2 + DWTR2rw.MyVal2;
					DWTRrw.MyVal3 = DWTRrw.MyVal3 + DWTR2rw.MyVal3;
          DWTRrw.MyVal4 = DWTRrw.MyVal4 + DWTR2rw.MyVal4;
					DWTRrw.MyVal5 = DWTRrw.MyVal5 + DWTR2rw.MyVal5;
          DWTRrw.MyVal10 = DWTRrw.MyVal10 + DWTR2rw.MyVal10;
          DWTRrw.MyVal11 = DWTRrw.MyVal11 + DWTR2rw.MyVal11;
          DWTRrw.MyVal12 = DWTRrw.MyVal12 + DWTR2rw.MyVal12;
          DWTRrw.MyVal13 = DWTRrw.MyVal13 + DWTR2rw.MyVal13;
          DWTRrw.MyVal14 = DWTRrw.MyVal14 + DWTR2rw.MyVal14;
          DWTRrw.MyVal15 = DWTRrw.MyVal15 + DWTR2rw.MyVal15;
          DWTRrw.MyVal16 = DWTRrw.MyVal16 + DWTR2rw.MyVal16;
          DWTRrw.MyVal17 = DWTRrw.MyVal17 + DWTR2rw.MyVal17;
          DWTRrw.MyVal18 = DWTRrw.MyVal18 + DWTR2rw.MyVal18;
          MatRowPut(DWTR2r,j,DWTRrw);
					MatRowDelete(DWTR2r,i);
					i = i - 1;
					rwcnt2 = rwcnt2 - 1;
				end;
			end;
		end;
		rwcnt = MatRowCnt(DWTRr);
		for (i=0;i<rwcnt2;i=i+1) begin
			MatRowGet(DWTR2r,i,DWTRrw);
			DWTR2rw.NomVal = DWTRrw.NomVal;
      DWTR2rw.MyVal10 = DWTRrw.MyVal10;
      DWTR2rw.MyVal11 = DWTRrw.MyVal11;
      DWTR2rw.MyVal12 = DWTRrw.MyVal12;
			DWTR2rw.CredVal2 = DWTRrw.CredVal2;
			DWTR2rw.DebVal2 = DWTRrw.DebVal2;
			DWTR2rw.Qty = DWTRrw.Qty;
			DWTR2rw.DebVal = DWTRrw.DebVal;
      DWTR2rw.MyVal5 = DWTRrw.MyVal5;
      DWTR2rw.MyVal13 = DWTRrw.MyVal13;
      DWTR2rw.MyVal14 = DWTRrw.MyVal14;
      DWTR2rw.MyVal15 = DWTRrw.MyVal15;
      DWTR2rw.MyVal1 = DWTRrw.MyVal1;
      DWTR2rw.MyVal3 = DWTRrw.MyVal3;
      DWTR2rw.MyVal4 = DWTRrw.MyVal4;
      DWTR2rw.MyVal2 = DWTRrw.MyVal2;
      DWTR2rw.MyVal16 = DWTRrw.MyVal16;
      DWTR2rw.MyVal17 = DWTRrw.MyVal17;
      DWTR2rw.MyVal18 = DWTRrw.MyVal18;
			DWTR2rw.Comment = "СЧ/КЛ.";
			DWTR2rw.ReconDate = DWTRrw.ReconDate;
			DWTR2rw.Curncy = "IVV";
			MatRowPut(DWTRr,rwcnt + i,DWTR2rw);
		end;
	end;
	rwcnt = MatRowCnt(DWTRr);
	for (j=0;j<rwcnt-1;j=j+1) begin
		for (i=0;i<rwcnt-1;i=i+1) begin
			MatRowGet(DWTRr,i,DWTRrw);
			MatRowGet(DWTRr,i+1,DWTR2rw);
			if (DWTRrw.ReconDate > DWTR2rw.ReconDate) then begin
				MatRowPut(DWTRr,i,DWTR2rw);
				MatRowPut(DWTRr,i+1,DWTRrw);
			end;
		end;
	end;
  v["AZNTermDeb"] = 0;
	v["AZNTermCred"] = 0;
	v["AZNDeb"] = 0;
	v["AZNCred"] = 0;
	v["EURDeb"] = 0;
	v["EURCred"] = 0;
	v["USDDeb"] = 0;
	v["USDCred"] = 0;
	v["BaseDeb"] = 0;
	v["BaseCred"] = 0;
	
  tabprintf[1] = true;
  tabprintf[36] = true;
  tabprintf[37] = true;
  if ((CurrentCompany==1) or (CurrentCompany==2) or (CurrentCompany==4) or (CurrentCompany==5) or 
      (CurrentCompany==6) or (CurrentCompany==7) or (CurrentCompany==8) or (CurrentCompany==11) or
      (CurrentCompany==12) or (CurrentCompany==16) or (CurrentCompany==25)) then begin
    tabprintf[12] = false;
    tabprintf[23] = false;
    tabprintf[24] = false;
    tabprintf[35] = false;
  end;
  
  if (RepSpec.sStartDate<StringToDate("1/1/2018")) then begin
    tabprintf[9] = false;
    tabprintf[10] = false;
    tabprintf[11] = false;
    tabprintf[20] = false;
    tabprintf[21] = false;
    tabprintf[22] = false;
    tabprintf[32] = false;
    tabprintf[33] = false;
    tabprintf[34] = false;
  end;
  j = 0;
  for (i=1;i<=37;i=i+1) begin
    if (tabprintf[i]) then begin j = j + 1; end;
  end;
  step = Round((480/(j+1)),rnd);
  tab[1]  = 0;
  j = 1;
  for (i=2;i<=37;i=i+1) begin
    if (tabprintf[i]) then begin
      tab[i] = tab[j] + step;
      j = i;
    end;
  end;
	
	StartReportNoHeaderJob("Еженедельный отчет директоров");
		StartFormat(15);
			OutString(0,0,"",false);
			if nonblank(RepSpec.ObjStr) then begin
				Objr.Code = RepSpec.ObjStr;
				ReadFirstMain(Objr,1,true);
				OutString(15,0,Objr.Code & " " & Objr.Comment,false);
			end else begin
				OutString(15,0,"",false);
			end;
			OutString(120,0,"",false);
			OutString(130,0,"",false);
			OutString(140,0,"",false);
			OutString(150,0,"",false);
			OutString(265,0,RepSpec.sStartDate & " : " & RepSpec.sEndDate,false);
		EndFormat;
		StartFormat(15);
		EndFormat;
    tempBal = 0;
		FindNLAccBal("51",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
    v["BeginBalance51"] = tempBal;
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="USD" then begin
				FindNLAccBal("50",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance50USD"] = v["BeginBalance50USD"] + tempBal;
			end;
		end;
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="EUR" then begin
				FindNLAccBal("50",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance50EUR"] = v["BeginBalance50EUR"] + tempBal;
			end;
		end;
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="AZN" then begin
				FindNLAccBal("50",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance50AZN"] = v["BeginBalance50AZN"] + tempBal;
			end;
		end;
    tempBal = 0;
		FindNLAccBal("50",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
    v["BeginBalance50"] = tempBal;
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="USD" then begin
				FindNLAccBal("53",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance53USD"] = v["BeginBalance53USD"] + tempBal;
			end;
		end;
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="EUR" then begin
				FindNLAccBal("53",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance53EUR"] = v["BeginBalance53EUR"] + tempBal;
			end;
		end;
		tempBal = 0;
		for (i=0;i<curi;i=i+1) begin
			if left(CurList[i],3)=="AZN" then begin
				FindNLAccBal("53",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
				v["BeginBalance53AZN"] = v["BeginBalance53AZN"] + tempBal;
			end;
		end;
    tempBal = 0;
		FindNLAccBal("53",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
    v["BeginBalance53"] = tempBal;
    
		v["BeginBalance50n51"] = v["BeginBalance50"] + v["BeginBalance51"];
		v["BeginBalance50n51n53"] = v["BeginBalance50n51"];
    v["BeginBalance50n53USD"] = v["BeginBalance50USD"];
    v["BeginBalance50n53EUR"] = v["BeginBalance50EUR"];
    v["BeginBalance50n53AZN"] = v["BeginBalance50AZN"];
    if (jewlf) then begin
      v["BeginBalance50n51n53"] = v["BeginBalance50n51n53"] + v["BeginBalance53"];
      v["BeginBalance50n53USD"] = v["BeginBalance50n53USD"] + v["BeginBalance53USD"];
      v["BeginBalance50n53EUR"] = v["BeginBalance50n53EUR"] + v["BeginBalance53EUR"];
      v["BeginBalance50n53AZN"] = v["BeginBalance50n53AZN"] + v["BeginBalance53AZN"];
    end;
		StartFormat(15);
		if (((jewlf) or (njewlf)) and (!cretivef)) then begin
		//Остаток на...
				OutString(0,0,"Остаток на " & RepSpec.sStartDate & ":",false);
			EndFormat;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="USD" then begin
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["Balance52USD"] = v["Balance52USD"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="EUR" then begin
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["Balance52EUR"] = v["Balance52EUR"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="AZN" then begin
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,CurList[i],0,"","",tempBal);
					v["Balance52AZN"] = v["Balance52AZN"] + tempBal;
				end;
			end;
			f = false;
			if ((v["Balance52USD"]!=0) or (v["Balance52EUR"]!=0)) then begin
				if (v["Balance52USD"]!=0) then begin
					StartFormat(15);
						if (!f) then begin
							OutString(0,0,"",false);
							OutString(15,0,"Остаток по расчетному счету в валюте:",false);
							f = true;
						end else begin
							OutString(0,0,"",false);
							OutString(15,0,"",false);
						end;
						OutString(60,0,v["Balance52USD"],false);
						OutString(90,0,"USD",false);
					EndFormat;
				end;
				if (v["Balance52EUR"]!=0) then begin
					StartFormat(15);
						if (!f) then begin
							OutString(0,0,"",false);
							OutString(15,0,"Остаток по расчетному счету в валюте:",false);
							f = true;
						end else begin
							OutString(0,0,"",false);
							OutString(15,0,"",false);
						end;
						OutString(60,0,v["Balance52EUR"],false);
						OutString(90,0,"EUR",false);
					EndFormat;
				end;
				if (v["Balance52AZN"]!=0) then begin
					StartFormat(15);
						if (!f) then begin
							OutString(0,0,"",false);
							OutString(15,0,"Остаток по расчетному счету в валюте:",false);
							f = true;
						end else begin
							OutString(0,0,"",false);
							OutString(15,0,"",false);
						end;
						OutString(60,0,v["Balance52AZN"],false);
						OutString(90,0,"AZN",false);
					EndFormat;
				end;
				StartFormat(15);
				EndFormat;
				if (f) then begin
          tempBal = 0;
					FindNLAccBal("52",RepSpec.ObjStr,"",0,"",RepSpec.sStartDate,0,0,false,"",0,"","",tempBal);
          v["BeginBalance52"] = tempBal;
					Gray_Divider(25,120);
					StartFormat(15);
						OutString(0,0,"",false);
						OutString(25,0,"Сумма в осн. вал.",false);
						OutString(60,0,v["BeginBalance52"],false);
						OutString(90,0,"AZN",false);
						if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
							OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
							OutMyString(160,0,v["BeginBalance52"]/RepSpec.vals0,false);
						end;
					EndFormat;
					Gray_Divider(25,120);
					StartFormat(15);
					EndFormat;
					v["BeginBalance50n51n53"] = v["BeginBalance50n51n53"] + v["BeginBalance52"];
				end;
			end;
			StartFormat(15);
				OutString(0,0,"",false);
				OutString(15,0,"Остаток общего счета",false);
				OutString(60,0,v["BeginBalance50n53USD"],false);
				OutString(90,0,"USD",false);
			EndFormat;
			StartFormat(15);
				OutString(0,0,"",false);
				OutString(15,0,"",false);
				OutString(60,0,v["BeginBalance50n53EUR"],false);
				OutString(90,0,"EUR",false);
			EndFormat;
			StartFormat(15);
				OutString(0,0,"",false);
				OutString(15,0,"",false);
				OutString(60,0,v["BeginBalance50n53AZN"],false);
				OutString(90,0,"AZN",false);
			EndFormat;
			StartFormat(15);
				OutString(0,0,"",false);
				OutString(15,0,"",false);
				OutString(60,0,v["BeginBalance51"],false);
				OutString(90,0,"AZN терминал",false);
			EndFormat;
      //Edit-------------------Vitalii 18:02 17.07.2017
      if (v["Balance52USD"]!=0) then begin
        StartFormat(15);
          OutString(0,0,"",false);
          OutString(15,0,"",false);
          OutString(60,0,v["Balance52USD"],false);
          OutString(90,0,"USD банк",false);
        EndFormat;
      end;
      if (v["Balance52EUR"]!=0) then begin
        StartFormat(15);
          OutString(0,0,"",false);
          OutString(15,0,"",false);
          OutString(60,0,v["Balance52EUR"],false);
          OutString(90,0,"EUR банк",false);
        EndFormat;
      end;
      if (v["Balance52AZN"]!=0) then begin
        StartFormat(15);
          OutString(0,0,"",false);
          OutString(15,0,"",false);
          OutString(60,0,v["Balance52AZN"],false);
          OutString(90,0,"AZN банк",false);
        EndFormat;
      end;
      
			Gray_Divider(25,120);
			StartFormat(15);
				OutString(0,0,"",false);
				OutString(25,0,"Сумма в осн. вал.",false);
				OutString(60,0,v["BeginBalance50n51n53"],false);
				OutString(90,0,"AZN",false);
				if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
					OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
					OutMyString(160,0,v["BeginBalance50n51n53"]/RepSpec.vals0,false);
				end;
			EndFormat;
			StartFormat(15);
			EndFormat;
      if (jewlf) then begin
        StartFormat(15);
          OutString(0,0,"",false);
          OutString(15,0,"Деньги в офисе",false);
          OutString(60,0,v["BeginBalance53USD"],false);
          OutString(90,0,"USD",false);
        EndFormat;
        StartFormat(15);
          OutString(0,0,"",false);
          OutString(15,0,"",false);
          OutString(60,0,v["BeginBalance53EUR"],false);
          OutString(90,0,"EUR",false);
        EndFormat;
        StartFormat(15);
          OutString(0,0,"",false);
          OutString(15,0,"",false);
          OutString(60,0,v["BeginBalance53AZN"],false);
          OutString(90,0,"AZN",false);
        EndFormat;
        Gray_Divider(25,120);
        StartFormat(15);
          OutString(0,0,"",false);
          OutString(25,0,"Сумма в осн. вал.",false);
          OutString(60,0,v["BeginBalance53"],false);
          OutString(90,0,"AZN",false);
          
          if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
            OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
            OutMyString(160,0,v["BeginBalance53"]/RepSpec.vals0,false);
          end;
        EndFormat;
        StartFormat(15);
        EndFormat;
      end;
		//Остаток на... по валютам
			if ((v["BeginBalance50USD"]!=0) or (v["BeginBalance50EUR"]!=0) or (v["BeginBalance51"]!=0)) then begin
        StartFormat(15);
          OutString(0,0,"Остаток на " & RepSpec.sStartDate & " по валютам:",false);
          OutString(15,0,"",false);
          OutString(60,0,v["BeginBalance50USD"],false);
          OutString(90,0,"USD",false);
        EndFormat;
        StartFormat(15);
          OutString(0,0,"",false);
          OutString(15,0,"",false);
          OutString(60,0,v["BeginBalance50EUR"],false);
          OutString(90,0,"EUR",false);
        EndFormat;
        StartFormat(15);
          OutString(0,0,"",false);
          OutString(15,0,"",false);
          OutString(60,0,v["BeginBalance50AZN"],false);
          OutString(90,0,"AZN",false);
        EndFormat;
        StartFormat(15);
          OutString(0,0,"",false);
          OutString(15,0,"",false);
          OutString(60,0,v["BeginBalance51"],false);
          OutString(90,0,"AZN терминал",false);
        EndFormat;
				StartFormat(15);
				EndFormat;
			end;
		end else begin
			if ((v["BeginBalance50AZN"]!=0) or (v["BeginBalance51"]!=0)) then begin
				StartFormat(15);
					OutString(0,0,"Остаток на " & RepSpec.sStartDate & " по валютам:",false);
				EndFormat;
				if (v["BeginBalance50AZN"]!=0) then begin
					StartFormat(15);
						OutString(0,0,"",false);
						OutString(15,0,"",false);
						OutString(60,0,v["BeginBalance50AZN"],false);
						OutString(90,0,"AZN",false);
					EndFormat;
				end;
				if (v["BeginBalance51"]!=0) then begin
					StartFormat(15);
						OutString(0,0,"",false);
						OutString(15,0,"",false);
						OutString(60,0,v["BeginBalance51"],false);
						OutString(90,0,"AZN терминал",false);
					EndFormat;
				end;
				StartFormat(15);
				EndFormat;
			end;
		end;
		Black_Divider(0,1);
	//Шапка таблицы
  /*tab[1]  -              Дата
    tab[2]  - Поступления:       AZN терминал
    tab[3]  - Поступления:       AZN банк
    tab[4]  - Поступления:       EUR банк
    tab[5]  - Поступления:       USD банк
    tab[6]  - Поступления:       AZN
    tab[7]  - Поступления:       EUR
    tab[8]  - Поступления:       USD
    tab[9]  - Поступления:       AZN офис
    tab[10] - Поступления:       EUR офис
    tab[11] - Поступления:       USD офис
    tab[12] - Поступления:       В осн. валюте
    tab[13] - Конвертация/банк:  AZN терминал
    tab[14] - Конвертация/банк:  AZN банк
    tab[15] - Конвертация/банк:  EUR банк
    tab[16] - Конвертация/банк:  USD банк
    tab[17] - Конвертация/банк:  AZN
    tab[18] - Конвертация/банк:  EUR
    tab[19] - Конвертация/банк:  USD
    tab[20] - Конвертация/банк:  AZN офис
    tab[21] - Конвертация/банк:  EUR офис
    tab[22] - Конвертация/банк:  USD офис
    tab[23] - Конвертация/банк:  В осн. валюте
    tab[24] -              Курсовая
    tab[25] - Расходы:           AZN терминал
    tab[26] - Расходы:           AZN банк
    tab[27] - Расходы:           EUR банк
    tab[28] - Расходы:           USD банк
    tab[29] - Расходы:           AZN
    tab[30] - Расходы:           EUR
    tab[31] - Расходы:           USD
    tab[32] - Расходы:           AZN офис
    tab[33] - Расходы:           EUR офис
    tab[34] - Расходы:           USD офис
    tab[35] - Расходы:           В осн. валюте
    tab[36] - Примечание:        Докум.
    tab[37] - Примечание:        Коммент.
    
    headtab[1] - Поступления
    headtab[2] - Конвертация/банк
    headtab[3] - Расходы
    headtab[4] - Примечание
    headtab[5],headtab[6]  - Divider Поступления
    headtab[7],headtab[8]  - Divider Конвертация/банк
    headtab[9],headtab[10] - Divider Расходы*/
//---------------------------------------------------------------------------------------------------------------------------------------------
    StartFormat(15);
      OutString(tab[1],0,"Дата",false);
      j = 0;
      k = 0;
      f = false;
      for (i=2;i<13;i=i+1) begin
        if (tabprintf[i]) then begin
          f = true;
          i = 13;
        end;
      end;
      if (f) then begin
        for (i=2;i<13;i=i+1) begin
          if (tabprintf[i]) then begin
            k = i;
            i = 13;
          end;
        end;
        for (i=13;i<38;i=i+1) begin
          if (tabprintf[i]) then begin
            j = i;
            i = 38;
          end;
        end;
        headtab[1] = tab[k] + (tab[j]-tab[k])/2;
        headtab[5] = tab[k];
        headtab[6] = tab[j] - 3;
        if (RepSpec.Media==mtExcel) then begin
          j = 0;
          for (i=2;i<13;i=i+1) begin
            if (tabprintf[i]) then begin
              j = j + 1;
            end;
          end;
          for (i=0;i<Round((j-1)/2,rnd);i=i+1) begin
            OutString(0,0,"",false);
          end;
        end;
        OutStringCut(headtab[1]-12,headtab[1]+12,0,"Поступления",true,0);
        if (RepSpec.Media==mtExcel) then begin
          for (i=0;i<(j-1-Round((j-1)/2,rnd));i=i+1) begin
            OutString(0,0,"",false);
          end;
        end;
      end;
        //OutStringCut(integer x, integer y,
        //			   integer und, string str,
        //			   boolean bool, integer ovst)
        //x    - начальная координата ячейки, в которую печатается
        //y    - конечная координата ячейки
        //und  - подчеркивание: 0 - нет / !=0 - да
        //str  - строка для вывода
        //bool - перенос ?
        //ovst - зачеркивание: 0-нет / !=0-да
      j = 0;
      k = 0;
      f = false;
      for (i=13;i<24;i=i+1) begin
        if (tabprintf[i]) then begin
          f = true;
          i = 24;
        end;
      end;
      if (f) then begin
        for (i=13;i<24;i=i+1) begin
          if (tabprintf[i]) then begin
            k = i;
            i = 24;
          end;
        end;
        for (i=24;i<37;i=i+1) begin
          if (tabprintf[i]) then begin
            j = i;
            i = 37;
          end;
        end;
        headtab[2] = tab[k] + (tab[j]-tab[k])/2;
        headtab[7] = tab[k] + 3;
        headtab[8] = tab[j] - 3;
        if (RepSpec.Media==mtExcel) then begin
          j = 0;
          for (i=13;i<24;i=i+1) begin
            if (tabprintf[i]) then begin
              j = j + 1;
            end;
          end;
          for (i=0;i<Round((j-1)/2,rnd);i=i+1) begin
            OutString(0,0,"",false);
          end;
        end;
        OutStringCut(headtab[2]-13,headtab[2]+13,0,"Конвертация/банк",true,0);
        if (RepSpec.Media==mtExcel) then begin
          for (i=0;i<(j-1-Round((j-1)/2,rnd));i=i+1) begin
            OutString(0,0,"",false);
          end;
        end;
      end;
      j = 0;
      k = 0;
      f = false;
      for (i=25;i<36;i=i+1) begin
        if (tabprintf[i]) then begin
          f = true;
          i = 36;
        end;
      end;
      if (f) then begin
        for (i=25;i<36;i=i+1) begin
          if (tabprintf[i]) then begin
            k = i;
            i = 36;
          end;
        end;
        j = 36;
        headtab[3] = tab[k] + (tab[j]-tab[k])/2;
        headtab[9] = tab[k] + 3;
        headtab[10] = tab[j] - 3;
        if (RepSpec.Media==mtExcel) then begin
          j = 0;
          for (i=25;i<36;i=i+1) begin
            if (tabprintf[i]) then begin
              j = j + 1;
            end;
          end;
          for (i=0;i<(Round((j-1)/2,rnd)+1);i=i+1) begin
            OutString(0,0,"",false);
          end;
        end;
        OutStringCut(headtab[3]-12,headtab[3]+12,0,"Расходы",true,0);
        if (RepSpec.Media==mtExcel) then begin
          for (i=0;i<(j-1-Round((j-1)/2,rnd));i=i+1) begin
            OutString(0,0,"",false);
          end;
        end;
      end;
      headtab[4] = tab[36] + (480-tab[36])/2;
      OutStringCut(headtab[4]-12,headtab[4]+12,0,"Примечание",false,0);
    EndFormat;

    if (headtab[1]!=0) then begin Black_Divider(headtab[5],headtab[6]); end;
    if (headtab[2]!=0) then begin Black_Divider(headtab[7],headtab[8]); end;
    if (headtab[3]!=0) then begin Black_Divider(headtab[9],headtab[10]); end;
    if (headtab[4]!=0) then begin Black_Divider(tab[36]+3,480); end;
		StartFormat(15);
			if (tabprintf[1]) then begin
				OutString(tab[1],0,"",false);
			end;
      if (tabprintf[2]) then begin
      	OutString(tab[2],0,"AZN терминал",false);
      end;
      if (tabprintf[3]) then begin
      	OutString(tab[3],0,"AZN банк",false);
      end;
      if (tabprintf[4]) then begin
      	OutString(tab[4],0,"EUR банк",false);
      end;
      if (tabprintf[5]) then begin
      	OutString(tab[5],0,"USD банк",false);
      end;
      if (tabprintf[6]) then begin
      	OutString(tab[6],0,"AZN",false); 
      end;
      if (tabprintf[7]) then begin
      	OutString(tab[7],0,"EUR",false);
      end;
      if (tabprintf[8]) then begin
      	OutString(tab[8],0,"USD",false);
      end;
      if (tabprintf[9]) then begin
      	OutString(tab[9],0,"AZN офис",false); 
      end;
      if (tabprintf[10]) then begin
      	OutString(tab[10],0,"EUR офис",false);
      end;
      if (tabprintf[11]) then begin
      	OutString(tab[11],0,"USD офис",false);
      end;
      if (tabprintf[12]) then begin
      	OutString(tab[12],0,"В осн. валюте",false);
        if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
          OutString(tab[12]+25,0,"В USD по курсу: " & RepSpec.vals0,false);
        end;
      end;
      if (tabprintf[13]) then begin
      	OutString(tab[13],0,"AZN терминал",false);
      end;
      if (tabprintf[14]) then begin
      	OutString(tab[14],0,"AZN банк",false);
      end;
      if (tabprintf[15]) then begin
      	OutString(tab[15],0,"EUR банк",false);
      end;
      if (tabprintf[16]) then begin
      	OutString(tab[16],0,"USD банк",false);
      end;
      if (tabprintf[17]) then begin
      	OutString(tab[17],0,"AZN",false);
      end;
      if (tabprintf[18]) then begin
      	OutString(tab[18],0,"EUR",false);
      end;
      if (tabprintf[19]) then begin
      	OutString(tab[19],0,"USD",false);
      end;
      if (tabprintf[20]) then begin
      	OutString(tab[20],0,"AZN офис",false); 
      end;
      if (tabprintf[21]) then begin
      	OutString(tab[21],0,"EUR офис",false);
      end;
      if (tabprintf[22]) then begin
      	OutString(tab[22],0,"USD офис",false);
      end;
      if (tabprintf[23]) then begin
      	OutString(tab[23],0,"В осн. валюте",false);
        if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
          OutString(tab[23]+25,0,"В USD по курсу: " & RepSpec.vals0,false);
        end;
      end;
			if (tabprintf[24]) then begin
				OutString(tab[24],0,"Курсовая",false);
			end;
      if (tabprintf[25]) then begin
      	OutString(tab[25],0,"AZN терминал",false);
      end;
      if (tabprintf[26]) then begin
      	OutString(tab[26],0,"AZN банк",false);
      end;
      if (tabprintf[27]) then begin
      	OutString(tab[27],0,"EUR банк",false);
      end;
      if (tabprintf[28]) then begin
      	OutString(tab[28],0,"USD банк",false);
      end;
      if (tabprintf[29]) then begin
      	OutString(tab[29],0,"AZN",false);
      end;
      if (tabprintf[30]) then begin
      	OutString(tab[30],0,"EUR",false);
      end;
      if (tabprintf[31]) then begin
      	OutString(tab[31],0,"USD",false);
      end;
      if (tabprintf[32]) then begin
      	OutString(tab[32],0,"AZN офис",false); 
      end;
      if (tabprintf[33]) then begin
      	OutString(tab[33],0,"EUR офис",false);
      end;
      if (tabprintf[34]) then begin
      	OutString(tab[34],0,"USD офис",false);
      end;
      if (tabprintf[35]) then begin
      	OutString(tab[35],0,"В осн. валюте",false);
        if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
          OutString(tab[35]+25,0,"В USD по курсу: " & RepSpec.vals0,false);
        end;
      end;
			if (tabprintf[36]) then begin
				OutString(tab[36],0,"Докум.",false);
			end;
			if (tabprintf[37]) then begin
				OutString(tab[37],0,"Коммент.",false);
			end;
		EndFormat;

		rwcnt = MatRowCnt(DWTRr);
		for (i=0;i<rwcnt;i=i+1) begin
			MatRowGet(DWTRr,i,DWTRrw);
			if (DWTRrw.ReconDate <> tempDate) then begin
				tempDate = DWTRrw.ReconDate;
				Black_Divider(0,1);
        StartFormat(15);
          if (tabprintf[1]) then begin
          	OutString(tab[1],0,tempDate,false);
          end;
        if (((jewlf) or (njewlf)) and (!cretivef)) then begin
          if (tabprintf[2]) then begin
          	OutString(tab[2],0,"",false);
          end;
          if (tabprintf[3]) then begin
          	OutString(tab[3],0,"",false);
          end;
          if (tabprintf[4]) then begin
          	OutString(tab[4],0,"",false);
          end;
          if (tabprintf[5]) then begin
          	OutString(tab[5],0,"",false);
          end;
          if (tabprintf[6]) then begin
          	OutString(tab[6],0,"",false);
          end;
          if (tabprintf[7]) then begin
          	OutString(tab[7],0,"",false);
          end;
          if (tabprintf[8]) then begin
          	OutString(tab[8],0,"",false);
          end;
          if (tabprintf[9]) then begin
          	OutString(tab[9],0,"",false);
          end;
          if (tabprintf[10]) then begin
          	OutString(tab[10],0,"",false);
          end;
          if (tabprintf[11]) then begin
          	OutString(tab[11],0,"",false);
          end;
          tempStr = "EUR";
          GetFullCurncyRate(tempStr,tempDate,fr,to1EUR,to2,br1,br2);
          if (tabprintf[12]) then begin
          	OutString(tab[12],0,"EUR: " & ValToMyString(to1EUR,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[12]+25,0,"",false);
            end;
          end;
          if (tabprintf[13]) then begin
          	OutString(tab[13],0,"",false);
          end;
          if (tabprintf[14]) then begin
          	OutString(tab[14],0,"",false);
          end;
          if (tabprintf[15]) then begin
          	OutString(tab[15],0,"",false);
          end;
          if (tabprintf[16]) then begin
          	OutString(tab[16],0,"",false);
          end;
          if (tabprintf[17]) then begin
          	OutString(tab[17],0,"",false); 
          end;
          if (tabprintf[18]) then begin
          	OutString(tab[18],0,"",false);
          end;
          if (tabprintf[19]) then begin
          	OutString(tab[19],0,"",false);
          end;
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,"",false);
          end;
          if (tabprintf[21]) then begin
          	OutString(tab[21],0,"",false);
          end;
          if (tabprintf[22]) then begin
          	OutString(tab[22],0,"",false);
          end;
          if (tabprintf[23]) then begin
          	OutString(tab[23],0,"EUR: " & ValToMyString(to1EUR,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[23]+25,0,"",false);
            end;
          end;
          if (tabprintf[24]) then begin
          	OutString(tab[24],0,"",false);
          end;
          if (tabprintf[25]) then begin
          	OutString(tab[25],0,"",false);
          end;
          if (tabprintf[26]) then begin
          	OutString(tab[26],0,"",false);
          end;
          if (tabprintf[27]) then begin
          	OutString(tab[27],0,"",false);
          end;
          if (tabprintf[28]) then begin
          	OutString(tab[28],0,"",false);
          end;
          if (tabprintf[29]) then begin
          	OutString(tab[29],0,"",false);
          end;
          if (tabprintf[30]) then begin
          	OutString(tab[30],0,"",false);
          end;
          if (tabprintf[31]) then begin
          	OutString(tab[31],0,"",false);
          end;
          if (tabprintf[32]) then begin
          	OutString(tab[32],0,"",false);
          end;
          if (tabprintf[33]) then begin
          	OutString(tab[33],0,"",false);
          end;
          if (tabprintf[34]) then begin
          	OutString(tab[34],0,"",false);
          end;
          if (tabprintf[35]) then begin
          	OutString(tab[35],0,"EUR: " & ValToMyString(to1EUR,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[35]+25,0,"",false);
            end;
          end;
          if (tabprintf[36]) then begin
          	OutString(tab[36],0,"",false);
          end;
          if (tabprintf[37]) then begin
          	OutString(tab[37],0,"Курс на " & tempDate,false);
          end;
        EndFormat;
        Gray_Divider(0,1);
        StartFormat(15);
          if (tabprintf[1]) then begin
          	OutString(tab[1],0,"",false);
          end;
          if (tabprintf[2]) then begin
          	OutString(tab[2],0,"",false);
          end;
          if (tabprintf[3]) then begin
          	OutString(tab[3],0,"",false);
          end;
          if (tabprintf[4]) then begin
          	OutString(tab[4],0,"",false);
          end;
          if (tabprintf[5]) then begin
          	OutString(tab[5],0,"",false);
          end;
          if (tabprintf[6]) then begin
          	OutString(tab[6],0,"",false);
          end;
          if (tabprintf[7]) then begin
          	OutString(tab[7],0,"",false);
          end;
          if (tabprintf[8]) then begin
          	OutString(tab[8],0,"",false);
          end;
          if (tabprintf[9]) then begin
          	OutString(tab[9],0,"",false);
          end;
          if (tabprintf[10]) then begin
          	OutString(tab[10],0,"",false);
          end;
          if (tabprintf[11]) then begin
          	OutString(tab[11],0,"",false);
          end;
          tempStr = "USD";
          GetFullCurncyRate(tempStr,tempDate,fr,to1USD,to2,br1,br2);
          if (tabprintf[12]) then begin
          	OutString(tab[12],0,"USD: " & ValToMyString(to1USD,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[12]+25,0,"",false);
            end;
          end;
          if (tabprintf[13]) then begin
          	OutString(tab[13],0,"",false);
          end;
          if (tabprintf[14]) then begin
          	OutString(tab[14],0,"",false);
          end;
          if (tabprintf[15]) then begin
          	OutString(tab[15],0,"",false);
          end;
          if (tabprintf[16]) then begin
          	OutString(tab[16],0,"",false);
          end;
          if (tabprintf[17]) then begin
          	OutString(tab[17],0,"",false); 
          end;
          if (tabprintf[18]) then begin
          	OutString(tab[18],0,"",false);
          end;
          if (tabprintf[19]) then begin
          	OutString(tab[19],0,"",false);
          end;
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,"",false);
          end;
          if (tabprintf[21]) then begin
          	OutString(tab[21],0,"",false);
          end;
          if (tabprintf[22]) then begin
          	OutString(tab[22],0,"",false);
          end;
          if (tabprintf[23]) then begin
          	OutString(tab[23],0,"USD: " & ValToMyString(to1USD,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[23]+25,0,"",false);
            end;
          end;
          if (tabprintf[24]) then begin
          	OutString(tab[24],0,"",false);
          end;
          if (tabprintf[25]) then begin
          	OutString(tab[25],0,"",false);
          end;
          if (tabprintf[26]) then begin
          	OutString(tab[26],0,"",false);
          end;
          if (tabprintf[27]) then begin
          	OutString(tab[27],0,"",false);
          end;
          if (tabprintf[28]) then begin
          	OutString(tab[28],0,"",false);
          end;
          if (tabprintf[29]) then begin
          	OutString(tab[29],0,"",false);
          end;
          if (tabprintf[30]) then begin
          	OutString(tab[30],0,"",false);
          end;
          if (tabprintf[31]) then begin
          	OutString(tab[31],0,"",false);
          end;
          if (tabprintf[32]) then begin
          	OutString(tab[32],0,"",false);
          end;
          if (tabprintf[33]) then begin
          	OutString(tab[33],0,"",false);
          end;
          if (tabprintf[34]) then begin
          	OutString(tab[34],0,"",false);
          end;
          if (tabprintf[35]) then begin
          	OutString(tab[35],0,"USD: " & ValToMyString(to1USD,5),false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[35]+25,0,"",false);
            end;
          end;
          if (tabprintf[36]) then begin
          	OutString(tab[36],0,"",false);
          end;
          if (tabprintf[37]) then begin
          	OutString(tab[37],0,"Курс на " & tempDate,false);
          end;
        EndFormat;
        Gray_Divider(0,1);
        StartFormat(15);
          if (tabprintf[1]) then begin
            OutString(tab[1],0,"",false);
          end;
        end;
			end else begin
				Gray_Divider(0,1);
				StartFormat(15);
					if (tabprintf[1]) then begin
						OutString(tab[1],0,"",false);
					end;
			end;
			switch (DWTRrw.Curncy) begin
				case "AZN":
          if (tabprintf[2]) then begin
          	OutString(tab[2],0,"",false);
          end;
          if (tabprintf[3]) then begin
          	OutString(tab[3],0,DWTRrw.MyVal7,false);
            v["AZN52Deb"] = v["AZN52Deb"] + DWTRrw.MyVal7;
          end;
          if (setinset("7",DWTRrw.TFromCode)) then begin
            v["Base52Deb"] = v["Base52Deb"] + DWTRrw.DebVal;
          end;
          if (tabprintf[4]) then begin
          	OutString(tab[4],0,"",false);
          end;
          if (tabprintf[5]) then begin
          	OutString(tab[5],0,"",false);
          end;
          if (tabprintf[6]) then begin
          	OutString(tab[6],0,DWTRrw.CurDebVal,false);
            v["AZNDeb"] = v["AZNDeb"] + DWTRrw.CurDebVal;
          end;
          if (tabprintf[7]) then begin
          	OutString(tab[7],0,"",false);
          end;
          if (tabprintf[8]) then begin
          	OutString(tab[8],0,"",false);
          end;
          if (tabprintf[9]) then begin
          	OutString(tab[9],0,DWTRrw.MyVal16,false);
            v["AZN53Deb"] = v["AZN53Deb"] + DWTRrw.MyVal16;
            if (DWTRrw.MyVal16!=blankval) then begin
              v["Base53Deb"] = v["Base53Deb"] + DWTRrw.DebVal;
            end;
          end;
          if (tabprintf[10]) then begin
          	OutString(tab[10],0,"",false);
          end;
          if (tabprintf[11]) then begin
          	OutString(tab[11],0,"",false);
          end;
          if (tabprintf[12]) then begin
          	OutString(tab[12],0,DWTRrw.DebVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[12]+25,0,DWTRrw.DebVal/RepSpec.vals0,false);
            end;
          end;
          if (tabprintf[13]) then begin
          	OutString(tab[13],0,"",false);
          end;
          if (tabprintf[14]) then begin
          	OutString(tab[14],0,DWTRrw.MyVal8,false);
            v["AZN52Conv"] = v["AZN52Conv"] + DWTRrw.MyVal8;
          end;
          if (setinset("8",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          if (tabprintf[15]) then begin
          	OutString(tab[15],0,"",false);
          end;
          if (tabprintf[16]) then begin
          	OutString(tab[16],0,"",false);
          end;
          if (tabprintf[17]) then begin
          	OutString(tab[17],0,DWTRrw.MyVal1,false); 
            v["convtotal2"] = v["convtotal2"] + DWTRrw.MyVal1;
          end;
          if (tabprintf[18]) then begin
          	OutString(tab[18],0,"",false);
          end;
          if (tabprintf[19]) then begin
          	OutString(tab[19],0,"",false);
          end;
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,DWTRrw.MyVal18,false); 
            v["conv53AZN"] = v["conv53AZN"] + DWTRrw.MyVal18;
            if (DWTRrw.MyVal18!=blankval) then begin
              v["Base53Conv"] = v["Base53Conv"] + DWTRrw.MyVal2;
            end;
          end;
          if (tabprintf[21]) then begin
          	OutString(tab[21],0,"",false);
          end;
          if (tabprintf[22]) then begin
          	OutString(tab[22],0,"",false);
          end;
          if (tabprintf[23]) then begin
          	OutString(tab[23],0,DWTRrw.MyVal2,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[23]+25,0,DWTRrw.MyVal2/RepSpec.vals0,false);
            end;
          end;
					if (tabprintf[24]) then begin
						OutString(tab[24],0,DWTRrw.MyVal3,false);
					end;
          if (tabprintf[25]) then begin
          	OutString(tab[25],0,"",false);
          end;
          if (tabprintf[26]) then begin
          	OutString(tab[26],0,DWTRrw.MyVal9,false);
            v["AZN52Cred"] = v["AZN52Cred"] + DWTRrw.MyVal9;
          end;
          if (setinset("9",DWTRrw.TFromCode)) then begin
            v["Base52Cred"] = v["Base52Cred"] + DWTRrw.CredVal;
          end;
          if (tabprintf[27]) then begin
          	OutString(tab[27],0,"",false);
          end;
          if (tabprintf[28]) then begin
          	OutString(tab[28],0,"",false);
          end;
          if (tabprintf[29]) then begin
          	OutString(tab[29],0,DWTRrw.CurCredVal,false);
            v["AZNCred"] = v["AZNCred"] + DWTRrw.CurCredVal;
          end;
          if (tabprintf[30]) then begin
          	OutString(tab[30],0,"",false);
          end;
          if (tabprintf[31]) then begin
          	OutString(tab[31],0,"",false);
          end;
          if (tabprintf[32]) then begin
          	OutString(tab[32],0,DWTRrw.MyVal17,false);
            v["AZN53Cred"] = v["AZN53Cred"] + DWTRrw.MyVal17;
            if (DWTRrw.MyVal17!=blankval) then begin
              v["Base53Cred"] = v["Base53Cred"] + DWTRrw.CredVal;
            end;
          end;
          if (tabprintf[33]) then begin
          	OutString(tab[33],0,"",false);
          end;
          if (tabprintf[34]) then begin
          	OutString(tab[34],0,"",false);
          end;
          if (tabprintf[35]) then begin
          	OutString(tab[35],0,DWTRrw.CredVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[35]+25,0,DWTRrw.CredVal/RepSpec.vals0,false);
            end;
          end;
				case "EUR":
          if (tabprintf[2]) then begin
          	OutString(tab[2],0,"",false);
          end;
          if (tabprintf[3]) then begin
          	OutString(tab[3],0,"",false);
          end;
          if (tabprintf[4]) then begin
          	OutString(tab[4],0,DWTRrw.MyVal7,false);
            v["EUR52Deb"] = v["EUR52Deb"] + DWTRrw.MyVal7;
          end;
          if (setinset("7",DWTRrw.TFromCode)) then begin
            v["Base52Deb"] = v["Base52Deb"] + DWTRrw.DebVal;
          end;
          if (tabprintf[5]) then begin
          	OutString(tab[5],0,"",false);
          end;
          if (tabprintf[6]) then begin
          	OutString(tab[6],0,"",false);
          end;
          if (tabprintf[7]) then begin
          	OutString(tab[7],0,DWTRrw.CurDebVal,false);
            v["EURDeb"] = v["EURDeb"] + DWTRrw.CurDebVal;
          end;
          if (tabprintf[8]) then begin
          	OutString(tab[8],0,"",false);
          end;
          if (tabprintf[9]) then begin
          	OutString(tab[9],0,"",false);
          end;
          if (tabprintf[10]) then begin
          	OutString(tab[10],0,DWTRrw.MyVal16,false);
            v["EUR53Deb"] = v["EUR53Deb"] + DWTRrw.MyVal16;
            if (DWTRrw.MyVal16!=blankval) then begin
              v["Base53Deb"] = v["Base53Deb"] + DWTRrw.DebVal;
            end;
          end;
          if (tabprintf[11]) then begin
          	OutString(tab[11],0,"",false);
          end;
          if (tabprintf[12]) then begin
          	OutString(tab[12],0,DWTRrw.DebVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[12]+25,0,DWTRrw.DebVal/RepSpec.vals0,false);
            end;
          end;
          if (tabprintf[13]) then begin
          	OutString(tab[13],0,"",false);
          end;
          if (tabprintf[14]) then begin
          	OutString(tab[14],0,"",false);
          end;
          if (tabprintf[15]) then begin
          	OutString(tab[15],0,DWTRrw.MyVal8,false);
            v["EUR52Conv"] = v["EUR52Conv"] + DWTRrw.MyVal8;
          end;
          if (setinset("8",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          if (tabprintf[16]) then begin
          	OutString(tab[16],0,"",false);
          end;
          if (tabprintf[17]) then begin
          	OutString(tab[17],0,"",false); 
          end;
          if (tabprintf[18]) then begin
          	OutString(tab[18],0,DWTRrw.MyVal1,false);
            v["convtotal3"] = v["convtotal3"] + DWTRrw.MyVal1;
          end;
          if (tabprintf[19]) then begin
          	OutString(tab[19],0,"",false);
          end;
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,"",false); 
          end;
          if (tabprintf[21]) then begin
          	OutString(tab[21],0,DWTRrw.MyVal18,false);
            v["conv53EUR"] = v["conv53EUR"] + DWTRrw.MyVal18;
            if (DWTRrw.MyVal18!=blankval) then begin
              v["Base53Conv"] = v["Base53Conv"] + DWTRrw.MyVal2;
            end;
          end;
          if (tabprintf[22]) then begin
          	OutString(tab[22],0,"",false);
          end;
          if (tabprintf[23]) then begin
          	OutString(tab[23],0,DWTRrw.MyVal2,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[23]+25,0,DWTRrw.MyVal2/RepSpec.vals0,false);
            end;
          end;
					if (tabprintf[24]) then begin
						OutString(tab[24],0,DWTRrw.MyVal3,false);
					end;
          if (tabprintf[25]) then begin
          	OutString(tab[25],0,"",false);
          end;
          if (tabprintf[26]) then begin
          	OutString(tab[26],0,"",false);
          end;
          if (tabprintf[27]) then begin
          	OutString(tab[27],0,DWTRrw.MyVal9,false);
            v["EUR52Cred"] = v["EUR52Cred"] + DWTRrw.MyVal9;
          end;
          if (setinset("9",DWTRrw.TFromCode)) then begin
            v["Base52Cred"] = v["Base52Cred"] + DWTRrw.CredVal;
          end;
          if (tabprintf[28]) then begin
          	OutString(tab[28],0,"",false);
          end;
          if (tabprintf[29]) then begin
          	OutString(tab[29],0,"",false);
          end;
          if (tabprintf[30]) then begin
          	OutString(tab[30],0,DWTRrw.CurCredVal,false);
            v["EURCred"] = v["EURCred"] + DWTRrw.CurCredVal;
          end;
          if (tabprintf[31]) then begin
          	OutString(tab[31],0,"",false);
          end;
          if (tabprintf[32]) then begin
          	OutString(tab[32],0,"",false);
          end;
          if (tabprintf[33]) then begin
          	OutString(tab[33],0,DWTRrw.MyVal17,false);
            v["EUR53Cred"] = v["EUR53Cred"] + DWTRrw.MyVal17;
            if (DWTRrw.MyVal17!=blankval) then begin
              v["Base53Cred"] = v["Base53Cred"] + DWTRrw.CredVal;
            end;
          end;
          if (tabprintf[34]) then begin
          	OutString(tab[34],0,"",false);
          end;
          if (tabprintf[35]) then begin
          	OutString(tab[35],0,DWTRrw.CredVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[35]+25,0,DWTRrw.CredVal/RepSpec.vals0,false);
            end;
          end;
				case "USD":
          if (tabprintf[2]) then begin
            OutString(tab[2],0,"",false);
          end;
          if (tabprintf[3]) then begin
            OutString(tab[3],0,"",false);
          end;
          if (tabprintf[4]) then begin
            OutString(tab[4],0,"",false);
          end;
          if (tabprintf[5]) then begin
            OutString(tab[5],0,DWTRrw.MyVal7,false);
            v["USD52Deb"] = v["USD52Deb"] + DWTRrw.MyVal7;
          end;
          if (setinset("7",DWTRrw.TFromCode)) then begin
            v["Base52Deb"] = v["Base52Deb"] + DWTRrw.DebVal;
          end;
          if (tabprintf[6]) then begin
            OutString(tab[6],0,"",false);
          end;
          if (tabprintf[7]) then begin
            OutString(tab[7],0,"",false);
          end;
          if (tabprintf[8]) then begin
            OutString(tab[8],0,DWTRrw.CurDebVal,false);
            v["USDDeb"] = v["USDDeb"] + DWTRrw.CurDebVal;
          end;
          if (tabprintf[9]) then begin
            OutString(tab[9],0,"",false);
          end;
          if (tabprintf[10]) then begin
            OutString(tab[10],0,"",false);
          end;
          if (tabprintf[11]) then begin
            OutString(tab[11],0,DWTRrw.MyVal16,false);
            v["USD53Deb"] = v["USD53Deb"] + DWTRrw.MyVal16;
            if (DWTRrw.MyVal16!=blankval) then begin
              v["Base53Deb"] = v["Base53Deb"] + DWTRrw.DebVal;
            end;
          end;
          if (tabprintf[12]) then begin
            OutString(tab[12],0,DWTRrw.DebVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[12]+25,0,DWTRrw.DebVal/RepSpec.vals0,false);
            end;
          end;
          if (tabprintf[13]) then begin
            OutString(tab[13],0,"",false);
          end;
          if (tabprintf[14]) then begin
            OutString(tab[14],0,"",false);
          end;
          if (tabprintf[15]) then begin
            OutString(tab[15],0,"",false);
          end;
          if (tabprintf[16]) then begin
            OutString(tab[16],0,DWTRrw.MyVal8,false);
            v["USD52Conv"] = v["USD52Conv"] + DWTRrw.MyVal15;
          end;
          if (setinset("8",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          if (tabprintf[17]) then begin
            OutString(tab[17],0,"",false); 
          end;
          if (tabprintf[18]) then begin
            OutString(tab[18],0,"",false);
          end;
          if (tabprintf[19]) then begin
            OutString(tab[19],0,DWTRrw.MyVal1,false);
            v["convtotal4"] = v["convtotal4"] + DWTRrw.MyVal1;	
          end;
          if (tabprintf[20]) then begin
            OutString(tab[20],0,"",false); 
          end;
          if (tabprintf[21]) then begin
            OutString(tab[21],0,"",false);
          end;
          if (tabprintf[22]) then begin
            OutString(tab[22],0,DWTRrw.MyVal18,false);
            v["conv53USD"] = v["conv53USD"] + DWTRrw.MyVal18;
            if (DWTRrw.MyVal18!=blankval) then begin
              v["Base53Conv"] = v["Base53Conv"] + DWTRrw.MyVal2;
            end;
          end;
          if (tabprintf[23]) then begin
            OutString(tab[23],0,DWTRrw.MyVal2,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[23]+25,0,DWTRrw.MyVal2/RepSpec.vals0,false);
            end;
          end;
					if (tabprintf[24]) then begin
						OutString(tab[24],0,DWTRrw.MyVal3,false);
					end;
          if (tabprintf[25]) then begin
            OutString(tab[25],0,"",false);
          end;
          if (tabprintf[26]) then begin
            OutString(tab[26],0,"",false);
          end;
          if (tabprintf[27]) then begin
            OutString(tab[27],0,"",false);
          end;
          if (tabprintf[28]) then begin
            OutString(tab[28],0,DWTRrw.MyVal9,false);
            v["USD52Cred"] = v["USD52Cred"] + DWTRrw.MyVal9;
          end;
          if (setinset("9",DWTRrw.TFromCode)) then begin
            v["Base52Cred"] = v["Base52Cred"] + DWTRrw.CredVal;
          end;
          if (tabprintf[29]) then begin
            OutString(tab[29],0,"",false);
          end;
          if (tabprintf[30]) then begin
            OutString(tab[30],0,"",false);
          end;
          if (tabprintf[31]) then begin
            OutString(tab[31],0,DWTRrw.CurCredVal,false);
            v["USDCred"] = v["USDCred"] + DWTRrw.CurCredVal;
          end;
          if (tabprintf[32]) then begin
            OutString(tab[32],0,"",false);
          end;
          if (tabprintf[33]) then begin
            OutString(tab[33],0,"",false);
          end;
          if (tabprintf[34]) then begin
            OutString(tab[34],0,DWTRrw.MyVal17,false);
            v["USD53Cred"] = v["USD53Cred"] + DWTRrw.MyVal17;
            if (DWTRrw.MyVal17!=blankval) then begin
              v["Base53Cred"] = v["Base53Cred"] + DWTRrw.CredVal;
            end;
          end;
          if (tabprintf[35]) then begin
            OutString(tab[35],0,DWTRrw.CredVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[35]+25,0,DWTRrw.CredVal/RepSpec.vals0,false);
            end;
          end;
				case "TER":
          if (tabprintf[2]) then begin
          	OutString(tab[2],0,DWTRrw.CurDebVal,false);
            v["AZNTermDeb"] = v["AZNTermDeb"] + DWTRrw.CurDebVal;
          end;
          if (tabprintf[3]) then begin
            OutString(tab[3],0,"",false);
          end;
          if (tabprintf[4]) then begin
            OutString(tab[4],0,"",false);
          end;
          if (tabprintf[5]) then begin
            OutString(tab[5],0,"",false);
          end;
          if (tabprintf[6]) then begin
          	OutString(tab[6],0,"",false);
          end;
          if (tabprintf[7]) then begin
          	OutString(tab[7],0,"",false);
          end;
          if (tabprintf[8]) then begin
          	OutString(tab[8],0,"",false);
          end;
          if (tabprintf[9]) then begin
          	OutString(tab[9],0,"",false);
          end;
          if (tabprintf[10]) then begin
          	OutString(tab[10],0,"",false);
          end;
          if (tabprintf[11]) then begin
          	OutString(tab[11],0,"",false);
          end;
          if (tabprintf[12]) then begin
          	OutString(tab[12],0,DWTRrw.DebVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[12]+25,0,DWTRrw.DebVal/RepSpec.vals0,false);
            end;
          end;
          if (tabprintf[13]) then begin
          	OutString(tab[13],0,DWTRrw.MyVal1,false);
            v["convtotal1"] = v["convtotal1"] + DWTRrw.MyVal1;
          end;
          if (tabprintf[14]) then begin
            OutString(tab[14],0,"",false);
          end;
          if (tabprintf[15]) then begin
            OutString(tab[15],0,"",false);
          end;
          if (tabprintf[16]) then begin
            OutString(tab[16],0,"",false);
          end;
          if (tabprintf[17]) then begin
          	OutString(tab[17],0,"",false); 
          end;
          if (tabprintf[18]) then begin
          	OutString(tab[18],0,"",false);
          end;
          if (tabprintf[19]) then begin
          	OutString(tab[19],0,"",false);
          end;
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,"",false); 
          end;
          if (tabprintf[21]) then begin
          	OutString(tab[21],0,"",false);
          end;
          if (tabprintf[22]) then begin
          	OutString(tab[22],0,"",false);
          end;
          if (tabprintf[23]) then begin
          	OutString(tab[23],0,DWTRrw.MyVal2,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[23]+25,0,DWTRrw.MyVal2/RepSpec.vals0,false);
            end;
          end;
					if (tabprintf[24]) then begin
						OutString(tab[24],0,DWTRrw.MyVal3,false);
					end;
          if (tabprintf[25]) then begin
          	OutString(tab[25],0,DWTRrw.CurCredVal,false);
            v["AZNTermCred"] = v["AZNTermCred"] + DWTRrw.CurCredVal;
          end;
          if (tabprintf[26]) then begin
            OutString(tab[26],0,"",false);
          end;
          if (tabprintf[27]) then begin
            OutString(tab[27],0,"",false);
          end;
          if (tabprintf[28]) then begin
            OutString(tab[28],0,"",false);
          end;
          if (tabprintf[29]) then begin
          	OutString(tab[29],0,"",false);
          end;
          if (tabprintf[30]) then begin
          	OutString(tab[30],0,"",false);
          end;
          if (tabprintf[31]) then begin
          	OutString(tab[31],0,"",false);
          end;
          if (tabprintf[32]) then begin
          	OutString(tab[32],0,"",false); 
          end;
          if (tabprintf[33]) then begin
          	OutString(tab[33],0,"",false);
          end;
          if (tabprintf[34]) then begin
          	OutString(tab[34],0,"",false);
          end;
          if (tabprintf[35]) then begin
          	OutString(tab[35],0,DWTRrw.CredVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[35]+25,0,DWTRrw.CredVal/RepSpec.vals0,false);
            end;
          end;
				case "IVV":
          if (tabprintf[2]) then begin
          	OutString(tab[2],0,DWTRrw.NomVal,false);
          end;
          v["AZNTermDeb"] = v["AZNTermDeb"] + DWTRrw.NomVal;
          if (tabprintf[3]) then begin
            OutString(tab[3],0,DWTRrw.MyVal10,false);
            v["AZN52Deb"] = v["AZN52Deb"] + DWTRrw.MyVal10;
          end;
          if (tabprintf[4]) then begin
            OutString(tab[4],0,DWTRrw.MyVal11,false);
            v["EUR52Deb"] = v["EUR52Deb"] + DWTRrw.MyVal11;
          end;
          if (tabprintf[5]) then begin
            OutString(tab[5],0,DWTRrw.MyVal12,false);
            v["USD52Deb"] = v["USD52Deb"] + DWTRrw.MyVal12;
          end;
          if (tabprintf[6]) then begin
          	OutString(tab[6],0,DWTRrw.CredVal2,false);
            v["AZNDeb"] = v["AZNDeb"] + DWTRrw.CredVal2;
          end;
          if (tabprintf[7]) then begin
          	OutString(tab[7],0,DWTRrw.DebVal2,false);
            v["EURDeb"] = v["EURDeb"] + DWTRrw.DebVal2;
          end;
          if (tabprintf[8]) then begin
          	OutString(tab[8],0,DWTRrw.Qty,false);
            v["USDDeb"] = v["USDDeb"] + DWTRrw.Qty;
          end;
          if (tabprintf[9]) then begin
          	OutString(tab[9],0,"",false);
          end;
          if (tabprintf[10]) then begin
          	OutString(tab[10],0,"",false);
          end;
          if (tabprintf[11]) then begin
          	OutString(tab[11],0,"",false);
          end;
          if (tabprintf[12]) then begin
          	OutString(tab[12],0,DWTRrw.DebVal,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[12]+25,0,DWTRrw.DebVal/RepSpec.vals0,false);
            end;
          end;
          if (tabprintf[13]) then begin
          	OutString(tab[13],0,DWTRrw.MyVal5,false);
            v["convtotal1"] = v["convtotal1"] + DWTRrw.MyVal5;
          end;
          if (tabprintf[14]) then begin
            OutString(tab[14],0,DWTRrw.MyVal13,false);
            v["AZN52Conv"] = v["AZN52Conv"] + DWTRrw.MyVal13;
          end;
          if (setinset("13",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          if (tabprintf[15]) then begin
            OutString(tab[15],0,DWTRrw.MyVal14,false);
            v["EUR52Conv"] = v["EUR52Conv"] + DWTRrw.MyVal14;
          end;
          if (setinset("14",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          if (tabprintf[16]) then begin
            OutString(tab[16],0,DWTRrw.MyVal15,false);
            v["USD52Conv"] = v["USD52Conv"] + DWTRrw.MyVal15;
          end;
          if (setinset("15",DWTRrw.TFromCode)) then begin
            v["Base52Conv"] = v["Base52Conv"] + DWTRrw.MyVal2;
          end;
          if (tabprintf[17]) then begin
          	OutString(tab[17],0,DWTRrw.MyVal1,false); 
            v["convtotal2"] = v["convtotal2"] + DWTRrw.MyVal1;
          end;
          if (tabprintf[18]) then begin
          	OutString(tab[18],0,DWTRrw.MyVal3,false);
            v["convtotal3"] = v["convtotal3"] + DWTRrw.MyVal3;
          end;
          if (tabprintf[19]) then begin
          	OutString(tab[19],0,DWTRrw.MyVal4,false);
            v["convtotal4"] = v["convtotal4"] + DWTRrw.MyVal4;
          end;
          if (tabprintf[20]) then begin
          	OutString(tab[20],0,"",false);
          end;
          if (tabprintf[21]) then begin
          	OutString(tab[21],0,"",false);
          end;
          if (tabprintf[22]) then begin
          	OutString(tab[22],0,"",false);
          end;
          if (tabprintf[23]) then begin
          	OutString(tab[23],0,DWTRrw.MyVal2,false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutMyString(tab[23]+25,0,DWTRrw.MyVal2/RepSpec.vals0,false);
            end;
          end;
					if (tabprintf[24]) then begin
						OutString(tab[24],0,DWTRrw.MyVal6,false);
					end;
          if (tabprintf[25]) then begin
          	OutString(tab[25],0,"",false);
          end;
          if (tabprintf[26]) then begin
          	OutString(tab[26],0,"",false);
          end;
          if (tabprintf[27]) then begin
          	OutString(tab[27],0,"",false);
          end;
          if (tabprintf[28]) then begin
          	OutString(tab[28],0,"",false);
          end;
          if (tabprintf[29]) then begin
          	OutString(tab[29],0,"",false);
          end;
          if (tabprintf[30]) then begin
          	OutString(tab[30],0,"",false);
          end;
          if (tabprintf[31]) then begin
          	OutString(tab[31],0,"",false);
          end;
          if (tabprintf[32]) then begin
          	OutString(tab[32],0,"",false);
          end;
          if (tabprintf[33]) then begin
          	OutString(tab[33],0,"",false);
          end;
          if (tabprintf[34]) then begin
          	OutString(tab[34],0,"",false);
          end;
          if (tabprintf[35]) then begin
          	OutString(tab[35],0,"",false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(tab[35]+25,0,"",false);
            end;
          end;
			end;
			v["BaseDeb"] = v["BaseDeb"] + DWTRrw.DebVal;
			v["BaseCred"] = v["BaseCred"] + DWTRrw.CredVal;
			v["convtotal5"] = v["convtotal5"] + DWTRrw.MyVal2;
			
			switch (FirstTransTypeInRange(DWTRrw.Comment)) begin
				case IVYc:
					OutStringID(tab[36],"DblIVVc",DWTRrw.Comment,false,FirstTransInRange(DWTRrw.Comment));
					if(currentuser=="SA")then begin
						IVr.SerNr = FirstTransInRange(DWTRrw.Comment);
						if(readfirstmain(IVr,1,true))then begin
							outstring(tab[36],0,IVr.MachineName,false);
						end;
					end;
				case IPYc:
					OutStringID(tab[36],"DblIPVcID",DWTRrw.Comment,false,FirstTransInRange(DWTRrw.Comment));
				case CLInYc:
					OutStringID(tab[36],"DblCLInID",DWTRrw.Comment,false,FirstTransInRange(DWTRrw.Comment));
				case CLOutYc:
					OutStringID(tab[36],"DblCLOutID",DWTRrw.Comment,false,FirstTransInRange(DWTRrw.Comment));
				otherwise
					OutStringID(tab[36],"DblTrans",DWTRrw.Comment,false,CurrentCompany);
			end;
				if (tabprintf[37]) then begin
					OutString(tab[37],0,DWTRrw.ExtraComment,false);
				end;
			EndFormat;
		end;
		//Итого
		Black_Divider(0,1)
		StartFormat(15);
			if (tabprintf[1]) then begin
				OutString(tab[1],0,"Итого",false);
			end;
      if (tabprintf[2]) then begin
      	OutString(tab[2],0,v["AZNTermDeb"],false);
      end;
      if (tabprintf[3]) then begin
      	OutString(tab[3],0,v["AZN52Deb"],false);
      end;
      if (tabprintf[4]) then begin
      	OutString(tab[4],0,v["EUR52Deb"],false);
      end;
      if (tabprintf[5]) then begin
      	OutString(tab[5],0,v["USD52Deb"],false);
      end;
      if (tabprintf[6]) then begin
      	OutString(tab[6],0,v["AZNDeb"],false);
      end;
      if (tabprintf[7]) then begin
      	OutString(tab[7],0,v["EURDeb"],false);
      end;
      if (tabprintf[8]) then begin
      	OutString(tab[8],0,v["USDDeb"],false);
      end;
      if (tabprintf[9]) then begin
        OutString(tab[9],0,v["AZN53Deb"],false);
      end;
      if (tabprintf[10]) then begin
        OutString(tab[10],0,v["EUR53Deb"],false);
      end;
      if (tabprintf[11]) then begin
        OutString(tab[11],0,v["USD53Deb"],false);
      end;
      if (tabprintf[12]) then begin
      	OutString(tab[12],0,v["BaseDeb"],false);
        if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
          OutMyString(tab[12]+25,0,v["BaseDeb"]/RepSpec.vals0,false);
        end;
      end;
      if (tabprintf[13]) then begin
      	OutString(tab[13],0,v["convtotal1"],false); 
      end;
      if (tabprintf[14]) then begin
      	OutString(tab[14],0,v["AZN52Conv"],false);
      end;
      if (tabprintf[15]) then begin
      	OutString(tab[15],0,v["EUR52Conv"],false);
      end;
      if (tabprintf[16]) then begin
      	OutString(tab[16],0,v["USD52Conv"],false);
      end;
      if (tabprintf[17]) then begin
      	OutString(tab[17],0,v["convtotal2"],false); 
      end;
      if (tabprintf[18]) then begin
      	OutString(tab[18],0,v["convtotal3"],false);
      end;
      if (tabprintf[19]) then begin
      	OutString(tab[19],0,v["convtotal4"],false);
      end;
      if (tabprintf[20]) then begin
      	OutString(tab[20],0,v["conv53AZN"],false);
      end;
      if (tabprintf[21]) then begin
      	OutString(tab[21],0,v["conv53EUR"],false);
      end;
      if (tabprintf[22]) then begin
      	OutString(tab[22],0,v["conv53USD"],false);
      end;
      if (tabprintf[23]) then begin
      	OutString(tab[23],0,v["convtotal5"],false);
        if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
          OutMyString(tab[23]+25,0,v["convtotal5"]/RepSpec.vals0,false);
        end;
      end;
			if (tabprintf[24]) then begin
				OutString(tab[24],0,v["kursovaya"] + v["kursovaya52"],false);
			end;
      if (tabprintf[25]) then begin
      	OutString(tab[25],0,v["AZNTermCred"],false);
      end;
      if (tabprintf[26]) then begin
      	OutString(tab[26],0,v["AZN52Cred"],false);
      end;
      if (tabprintf[27]) then begin
      	OutString(tab[27],0,v["EUR52Cred"],false);
      end;
      if (tabprintf[28]) then begin
      	OutString(tab[28],0,v["USD52Cred"],false);
      end;
      if (tabprintf[29]) then begin
      	OutString(tab[29],0,v["AZNCred"],false);
      end;
      if (tabprintf[30]) then begin
      	OutString(tab[30],0,v["EURCred"],false);
      end;
      if (tabprintf[31]) then begin
      	OutString(tab[31],0,v["USDCred"],false);
      end;
      if (tabprintf[32]) then begin
      	OutString(tab[32],0,v["AZN53Cred"],false);
      end;
      if (tabprintf[33]) then begin
      	OutString(tab[33],0,v["EUR53Cred"],false);
      end;
      if (tabprintf[34]) then begin
      	OutString(tab[34],0,v["USD53Cred"],false);
      end;
      if (tabprintf[35]) then begin
      	OutString(tab[35],0,v["BaseCred"],false);
        if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
          OutMyString(tab[35]+25,0,v["BaseCred"]/RepSpec.vals0,false);
        end;
      end;
		EndFormat;
		Gray_Divider(0,1)
		StartFormat(15);
		EndFormat;
		
    //Оборот\Расход AZN ...
    tab[1] = 0;
		tab[2] = tab[1] + 15;   // Касса
		tab[3] = tab[2] + 10;   // Сумма в осн. вал./Курсовая
		tab[4] = tab[3] + 19;   // Сумма
		tab[5] = tab[4] + 25;   // Валюта
		tab[6] = tab[5] + 22;   // В USD по курсу: /divider end
		
    tab[7] = tab[6] + 15;   // propusk
		tab[8] = tab[7] + 15;   // Терминал
		tab[9] = tab[8] + 25;   // Сумма
		tab[10] = tab[9] +13;   // Расход AZN: В USD по курсу: 
    tab[11] = tab[10] + 11; // Валюта
		tab[12] = tab[11] + 9;  // В USD по курсу: 
    tab[13] = tab[12] + 16; // divider end
		
		tab[14] = tab[13] + 15; // propusk
		tab[15] = tab[14] + 15; // Банк
		tab[16] = tab[15] + 25; // Сумма
		tab[17] = tab[16] + 24; // Валюта
		tab[18] = tab[17] + 9;  // В USD по курсу: 
		tab[19] = tab[18] + 16; // divider end
    
    tab[20] = tab[19] + 15; // propusk
    tab[21] = tab[20] + 15; // Офис
		tab[22] = tab[21] + 25; // Сумма
		tab[23] = tab[22] + 24; // Валюта
		tab[24] = tab[23] + 9;  // В USD по курсу: 
		tab[25] = tab[24] + 16; // divider end
    
		StartFormat(15);
			OutString(tab[1],0,"",false);
			OutString(tab[2],0,"Оборот AZN:",false);
      OutString(tab[4],0,v["BaseDeb"],false);
      if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
				OutString(tab[5],0,"В USD по курсу: " & RepSpec.vals0,false);
				OutMyString(tab[6],0,v["BaseDeb"]/RepSpec.vals0,false);
			end else begin
				OutString(tab[5],0,"",false);
				OutString(tab[6],0,"",false);
			end;
      OutString(tab[7],0,"",false);
			OutString(tab[8],0,"Расход AZN:",false);
			OutString(tab[9],0,v["BaseCred"],false);
      if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
				OutString(tab[10],0,"В USD по курсу: " & RepSpec.vals0,false);
				OutMyString(tab[12],0,v["BaseCred"]/RepSpec.vals0,false);
			end;
		EndFormat;
		StartFormat(15);
		EndFormat;
		// Табл. 2,3
		Black_Divider(tab[2],tab[6]);
		Black_Divider(tab[8],tab[13]);
    Black_Divider(tab[15],tab[19]);
    if (RepSpec.sStartDate>=StringToDate("1/1/2018")) then begin
      Black_Divider(tab[21],tab[25]);
    end;
		StartFormat(15);
			OutString(tab[1],0,"",false);
			OutString(tab[2],0,"Касса",false);
			OutString(tab[4],0,"Сумма",false);
			OutString(tab[5],0,"Валюта",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[6],0,"В USD по курсу: " & RepSpec.vals0,false);
			end;
			OutString(tab[7],0,"",false);
			OutString(tab[8],0,"Терминал",false);
			OutString(tab[9],0,"Сумма",false);
			OutString(tab[11],0,"Валюта",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[12],0,"В USD по курсу: " & RepSpec.vals0,false);
			end;
      OutString(tab[14],0,"",false);
			OutString(tab[15],0,"Банк",false);
			OutString(tab[16],0,"Сумма",false);
			OutString(tab[17],0,"Валюта",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[18],0,"В USD по курсу: " & RepSpec.vals0,false);
			end;
      if (RepSpec.sStartDate>=StringToDate("1/1/2018")) then begin
        OutString(tab[20],0,"",false);
        OutString(tab[21],0,"Офис",false);
        OutString(tab[22],0,"Сумма",false);
        OutString(tab[23],0,"Валюта",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[24],0,"В USD по курсу: " & RepSpec.vals0,false);
        end;
      end;
		EndFormat;
		Black_Divider(tab[2],tab[6]);
		Black_Divider(tab[8],tab[13]);
    Black_Divider(tab[15],tab[19]);
    if (RepSpec.sStartDate>=StringToDate("1/1/2018")) then begin
      Black_Divider(tab[21],tab[25]);
    end;
		StartFormat(15);
			OutString(tab[1],0,"",false);
			OutString(tab[2],0,"Приход",false);// Касса - Приход
			OutString(tab[4],0,v["BaseDeb"] - v["AZNTermDeb"] - v["Base52Deb"],false);
			OutString(tab[5],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[6],0,(v["BaseDeb"] - v["AZNTermDeb"] - v["Base52Deb"])/RepSpec.vals0,false);
			end;
			OutString(tab[7],0,"",false);
			OutString(tab[8],0,"Приход",false);
			OutString(tab[9],0,v["AZNTermDeb"],false);
			OutString(tab[11],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[12],0,(v["AZNTermDeb"])/RepSpec.vals0,false);
			end;
      OutString(tab[14],0,"",false);
			OutString(tab[15],0,"Приход",false);
			OutString(tab[16],0,v["Base52Deb"],false);
			OutString(tab[17],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[18],0,(v["Base52Deb"])/RepSpec.vals0,false);
			end;
      if (RepSpec.sStartDate>=StringToDate("1/1/2018")) then begin
        OutString(tab[20],0,"",false);
        OutString(tab[21],0,"Приход",false);
        OutString(tab[22],0,v["Base53Deb"],false);
        OutString(tab[23],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[24],0,(v["Base53Deb"])/RepSpec.vals0,false);
        end;
      end;
		EndFormat;
		Gray_Divider(tab[2],tab[6]);
		Gray_Divider(tab[8],tab[13]);
    Gray_Divider(tab[15],tab[19]);
    if (RepSpec.sStartDate>=StringToDate("1/1/2018")) then begin
      Gray_Divider(tab[21],tab[25]);
    end;
		StartFormat(15);
			OutString(tab[1],0,"",false);
			OutString(tab[2],0,"Расход",false);// Касса - Расход
			OutString(tab[4],0,v["BaseCred"] - v["AZNTermCred"] - v["Base52Cred"],false);
			OutString(tab[5],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[6],0,(v["BaseCred"] - v["AZNTermCred"] - v["Base52Cred"])/RepSpec.vals0,false);
			end;
			OutString(tab[7],0,"",false);
			OutString(tab[8],0,"Расход",false);
			OutString(tab[9],0,v["AZNTermCred"],false);
			OutString(tab[11],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[12],0,(v["AZNTermCred"])/RepSpec.vals0,false);
			end;
      OutString(tab[14],0,"",false);
			OutString(tab[15],0,"Расход",false);
			OutString(tab[16],0,v["Base52Cred"],false);
			OutString(tab[17],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[18],0,(v["Base52Cred"])/RepSpec.vals0,false);
			end;
      if (RepSpec.sStartDate>=StringToDate("1/1/2018")) then begin
        OutString(tab[20],0,"",false);
        OutString(tab[21],0,"Расход",false);
        OutString(tab[22],0,v["Base53Cred"],false);
        OutString(tab[23],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[24],0,(v["Base53Cred"])/RepSpec.vals0,false);
        end;
      end;
		EndFormat;
		Gray_Divider(tab[2],tab[6]);
		Gray_Divider(tab[8],tab[13]);
    Gray_Divider(tab[15],tab[19]);
    if (RepSpec.sStartDate>=StringToDate("1/1/2018")) then begin
      Gray_Divider(tab[21],tab[25]);
    end;
		v["SaldoEndPeriod51"] = v["BeginBalance51"] + v["AZNTermDeb"] - v["AZNTermCred"] + v["convtotal1"];// Edit ************************** Thursday, 27 August 1515 15:22:19
		StartFormat(15);
			OutString(tab[1],0,"",false);
			OutString(tab[2],0,"Конв/банк",false);
			OutString(tab[4],0,v["convtotal2"],false);
			OutString(tab[5],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[6],0,(v["convtotal2"])/RepSpec.vals0,false);
			end;
			OutString(tab[7],0,"",false);
			OutString(tab[8],0,"Конв/банк",false);
			OutString(tab[9],0,v["convtotal1"],false);
			OutString(tab[11],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[12],0,(v["convtotal1"])/RepSpec.vals0,false);
			end;
      OutString(tab[14],0,"",false);
			OutString(tab[15],0,"Конв/банк",false);
			OutString(tab[16],0,v["Base52Conv"],false);
			OutString(tab[17],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[18],0,(v["Base52Conv"])/RepSpec.vals0,false);
			end;
      if (RepSpec.sStartDate>=StringToDate("1/1/2018")) then begin
        OutString(tab[20],0,"",false);
        OutString(tab[21],0,"Конв/банк",false);
        OutString(tab[22],0,v["Base53Conv"],false);
        OutString(tab[23],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[24],0,(v["Base53Conv"])/RepSpec.vals0,false);
        end;
      end;
		EndFormat;
		Gray_Divider(tab[2],tab[6]);
    Black_Divider(tab[8],tab[13]);
    Black_Divider(tab[15],tab[19]);
    if (RepSpec.sStartDate>=StringToDate("1/1/2018")) then begin
      Black_Divider(tab[21],tab[25]);
    end;
    StartFormat(15);
      OutString(tab[1],0,"",false);
      OutString(tab[2],0,"Сдано",false);
      OutString(tab[4],0,v["handed53"],false);
      OutString(tab[5],0,"AZN",false);
      if(RepSpec.vals0!=0)then begin
        OutMyString(tab[6],0,(v["handed53"])/RepSpec.vals0,false);
      end;
    	OutString(tab[7],0,"",false);
			OutString(tab[8],0,"Остаток",false);
			OutString(tab[9],0,v["SaldoEndPeriod51"],false);
			OutString(tab[11],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[12],0,(v["SaldoEndPeriod51"])/RepSpec.vals0,false);
			end;
      OutString(tab[14],0,"",false);
			OutString(tab[15],0,"К сдаче",false);
      v["SaldoEndPeriod52"] = v["BeginBalance52"] + v["Base52Deb"] - v["Base52Cred"] + v["Base52Conv"];
			OutString(tab[16],0,v["SaldoEndPeriod52"] - v["kursovaya52"],false);
			OutString(tab[17],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutString(tab[18],0,(v["SaldoEndPeriod52"] - v["kursovaya52"])/RepSpec.vals0,false);
			end;
      if (RepSpec.sStartDate>=StringToDate("1/1/2018")) then begin
        OutString(tab[20],0,"",false);
        OutString(tab[21],0,"К сдаче",false);
        v["SaldoEndPeriod53"] = v["BeginBalance53"] + v["Base53Deb"] - v["Base53Cred"] + v["Base53Conv"];
        OutString(tab[22],0,v["SaldoEndPeriod53"] - v["kursovaya53"],false);
        OutString(tab[23],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[24],0,(v["SaldoEndPeriod53"] - v["kursovaya53"])/RepSpec.vals0,false);
        end;
      end;
		EndFormat;
		Black_Divider(tab[8],tab[13]);
		if (((jewlf) or (njewlf)) and (!cretivef)) or (v["BalItem1"] != 0) then begin
			Gray_Divider(tab[2],tab[6]);
			StartFormat(15);
        OutString(tab[1],0,"",false);
				if (prihodprntdf) then begin
          rashodprntdf = true;
          OutString(tab[2],0,"Расход за товар",false);
          OutString(tab[4],0,v["BalItem2"],false);
          OutString(tab[5],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin
            OutMyString(tab[6],0,(v["BalItem2"])/RepSpec.vals0,false);
          end;
        end else begin
          OutString(tab[2],0,"Приход за товар",false);
          OutString(tab[4],0,v["BalItem1"],false);
          OutString(tab[5],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin
            OutMyString(tab[6],0,(v["BalItem1"])/RepSpec.vals0,false);
          end;
        end;
		end else begin
      StartFormat(15);
				OutString(tab[1],0,"",false);
				OutString(tab[2],0,"",false);
				OutString(tab[4],0,"",false);
				OutString(tab[5],0,"",false);
				if(RepSpec.vals0!=0)then begin
					OutString(tab[6],0,"",false);
				end;
    end;
      OutString(tab[7],0,"",false);
      OutString(tab[8],0,"",false);
      OutString(tab[9],0,"",false);
      OutString(tab[11],0,"",false);
      if(RepSpec.vals0!=0)then begin
        OutString(tab[12],0,"",false);
      end;
      OutString(tab[14],0,"",false);
      OutString(tab[15],0,"Курсовая",false);
      OutString(tab[16],0,v["kursovaya52"],false);
      OutString(tab[17],0,"AZN",false);
      if(RepSpec.vals0!=0)then begin
        OutString(tab[18],0,(v["kursovaya52"])/RepSpec.vals0,false);
      end;
      if (RepSpec.sStartDate>=StringToDate("1/1/2018")) then begin
        OutString(tab[20],0,"",false);
        OutString(tab[21],0,"Курсовая",false);
        OutString(tab[22],0,v["kursovaya53"],false);
        OutString(tab[23],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[24],0,(v["kursovaya53"])/RepSpec.vals0,false);
        end;
      end;
    EndFormat;
    Black_Divider(tab[15],tab[19]);
    v["SaldoEndPeriod50n51"] = v["BeginBalance50n51"] + (v["BaseDeb"] - v["Base52Deb"]) - (v["BaseCred"] - v["Base52Cred"]) + (v["convtotal5"] - v["Base52Conv"]);// Edit ************************** Thursday, 27 August 2015 15:22:15
		if (((jewlf) or (njewlf)) and (!cretivef)) or (v["BalItem2"] != 0) then begin
			Gray_Divider(tab[2],tab[6]);
			StartFormat(15);
				OutString(tab[1],0,"",false);
        if (rashodprntdf) then begin
          ksdacheprntdf = true;
          OutString(tab[2],0,"К сдаче",false);
          OutString(tab[4],0,v["SaldoEndPeriod50n51"] - v["kursovaya"],false);
          OutString(tab[5],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin
            OutMyString(tab[6],0,(v["SaldoEndPeriod50n51"] - v["kursovaya"])/RepSpec.vals0,false);
          end;
        end else begin
          OutString(tab[2],0,"Расход за товар",false);
          OutString(tab[4],0,v["BalItem2"],false);
          OutString(tab[5],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin
            OutMyString(tab[6],0,(v["BalItem2"])/RepSpec.vals0,false);
          end;
        end;
    end else begin
      StartFormat(15);
				OutString(tab[1],0,"",false);
				OutString(tab[2],0,"",false);
				OutString(tab[4],0,"",false);
				OutString(tab[5],0,"",false);
				if(RepSpec.vals0!=0)then begin
					OutString(tab[6],0,"",false);
				end;
		end;
      OutString(tab[7],0,"",false);
      OutString(tab[8],0,"",false);
      OutString(tab[9],0,"",false);
      OutString(tab[11],0,"",false);
      if(RepSpec.vals0!=0)then begin
        OutString(tab[12],0,"",false);
      end;
      OutString(tab[14],0,"",false);
      OutString(tab[15],0,"К сдаче",false);
      OutString(tab[16],0,v["SaldoEndPeriod52"],false);
      OutString(tab[17],0,"AZN",false);
      if(RepSpec.vals0!=0)then begin
        OutString(tab[18],0,(v["SaldoEndPeriod52"])/RepSpec.vals0,false);
      end;
      if (RepSpec.sStartDate>=StringToDate("1/1/2018")) then begin
        OutString(tab[20],0,"",false);
        OutString(tab[21],0,"К сдаче",false);
        OutString(tab[22],0,v["SaldoEndPeriod53"],false);
        OutString(tab[23],0,"AZN",false);
        if(RepSpec.vals0!=0)then begin
          OutString(tab[24],0,(v["SaldoEndPeriod53"])/RepSpec.vals0,false);
        end;
      end;
    EndFormat;
		Black_Divider(tab[2],tab[6]);
    
	// к сдаче
		v["SaldoEndPeriod50USD"] = v["BeginBalance50USD"] + v["USDDeb"] - v["USDCred"] + v["convtotal4"];// Edit ************************** Thursday, 27 August 2015 15:22:15
		v["SaldoEndPeriod50EUR"] = v["BeginBalance50EUR"] + v["EURDeb"] - v["EURCred"] + v["convtotal3"];// Edit ************************** Thursday, 27 August 2015 15:22:16
		v["SaldoEndPeriod50AZN"] = v["BeginBalance50AZN"] + v["AZNDeb"] - v["AZNCred"] + v["convtotal2"];// Edit ************************** Thursday, 27 August 2015 15:22:17
		if (((jewlf) or (njewlf)) and (!cretivef)) or (v["kursovaya"] != 0) then begin
			if (!ksdacheprntdf) then begin
        StartFormat(15);
          OutString(tab[1],0,"",false);
          OutString(tab[2],0,"К сдаче",false);
          OutString(tab[4],0,v["SaldoEndPeriod50n51"] - v["kursovaya"],false);
          OutString(tab[5],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin
            OutMyString(tab[6],0,(v["SaldoEndPeriod50n51"] - v["kursovaya"])/RepSpec.vals0,false);
          end;
        EndFormat;
      end;
			StartFormat(15);
				OutString(tab[1],0,"",false);
				OutString(tab[2],0,"Курсовая",false);
				OutString(tab[4],0,v["kursovaya"],false);
				OutString(tab[5],0,"AZN",false);
				if(RepSpec.vals0!=0)then begin
					OutMyString(tab[6],0,(v["kursovaya"])/RepSpec.vals0,false);
				end;
			EndFormat;
			Black_Divider(tab[2],tab[6]);
		end;
		StartFormat(15);
			OutString(tab[1],0,"",false);
			OutString(tab[2],0,"К сдаче",false);
			OutString(tab[4],0,v["SaldoEndPeriod50n51"],false);
			OutString(tab[5],0,"AZN",false);
			if(RepSpec.vals0!=0)then begin
				OutMyString(tab[6],0,(v["SaldoEndPeriod50n51"])/RepSpec.vals0,false);
			end;
		EndFormat;
		
		StartFormat(15);
		EndFormat;
		StartFormat(15);
			OutString(tab[1],0,"",false);
			OutString(tab[2],0,"К сдаче по валютам",false);
		EndFormat;
		if (((jewlf) or (njewlf)) and (!cretivef)) or (v["SaldoEndPeriod50USD"] != 0) then begin
			StartFormat(15);
				OutString(tab[1],0,"",false);
				OutString(tab[2],0,"",false);
				OutString(tab[4],0,v["SaldoEndPeriod50USD"],false);
				OutString(tab[5],0,"USD",false);
			EndFormat;
		end;
		if (((jewlf) or (njewlf)) and (!cretivef)) or (v["SaldoEndPeriod50EUR"] != 0) then begin
			StartFormat(15);
				OutString(tab[1],0,"",false);
				OutString(tab[2],0,"",false);
				OutString(tab[4],0,v["SaldoEndPeriod50EUR"],false);
				OutString(tab[5],0,"EUR",false);
			EndFormat;
		end;
		if (((jewlf) or (njewlf)) and (!cretivef)) or (v["SaldoEndPeriod50AZN"] != 0) then begin
			StartFormat(15);
				OutString(tab[1],0,"",false);
				OutString(tab[2],0,"",false);
				OutString(tab[4],0,v["SaldoEndPeriod50AZN"],false);
				OutString(tab[5],0,"AZN",false);
			EndFormat;
		end;
		if (((jewlf) or (njewlf)) and (!cretivef)) or (v["SaldoEndPeriod51"] != 0) then begin
			StartFormat(15);
				OutString(tab[1],0,"",false);
				OutString(tab[2],0,"",false);
				OutString(tab[4],0,v["SaldoEndPeriod51"],false);
				OutString(tab[5],0,"AZN терминал",false);
			EndFormat;
		end;
		if (((jewlf) or (njewlf)) and (!cretivef)) then begin
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="USD" then begin
					FindNLAccBal("53",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod53USD"] = v["SaldoEndPeriod53USD"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="EUR" then begin
					FindNLAccBal("53",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod53EUR"] = v["SaldoEndPeriod53EUR"] + tempBal;
				end;
			end;
			tempBal = 0;
			for (i=0;i<curi;i=i+1) begin
				if left(CurList[i],3)=="AZN" then begin
					FindNLAccBal("53",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
					v["SaldoEndPeriod53AZN"] = v["SaldoEndPeriod53AZN"] + tempBal;
				end;
			end;
      tempBal = 0;
			FindNLAccBal("53",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,"",0,"","",tempBal);
      v["SaldoEndPeriod53"] = tempBal;
			StartFormat(15);
			EndFormat;
      if (jewlf) then begin
        StartFormat(15);
          OutString(tab[1],0,"",false);
          OutString(tab[2],0,"Деньги в офисе",false);
          OutString(tab[4],0,v["SaldoEndPeriod53USD"],false);
          OutString(tab[5],0,"USD",false);
        EndFormat;
        StartFormat(15);
          OutString(tab[1],0,"",false);
          OutString(tab[2],0,"",false);
          OutString(tab[4],0,v["SaldoEndPeriod53EUR"],false);
          OutString(tab[5],0,"EUR",false);
        EndFormat;
        StartFormat(15);
          OutString(tab[1],0,"",false);
          OutString(tab[2],0,"",false);
          OutString(tab[4],0,v["SaldoEndPeriod53AZN"],false);
          OutString(tab[5],0,"AZN",false);
        EndFormat;
        Gray_Divider(tab[3],90);
        StartFormat(15);
          OutString(tab[1],0,"",false);
          OutString(tab[3],0,"Сумма в осн. вал.",false);
          OutString(tab[4],0,v["SaldoEndPeriod53"],false);
          OutString(tab[5],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
            OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
            OutMyString(160,0,(v["SaldoEndPeriod53"])/RepSpec.vals0,false);
          end;
        EndFormat;
        Gray_Divider(tab[3],90);
        StartFormat(15);
          OutString(tab[1],0,"",false);
          OutString(tab[3],0,"Курсовая",false);
          OutString(tab[4],0,v["kursovaya53"],false);
          OutString(tab[5],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin
            OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
            OutMyString(160,0,(v["kursovaya53"])/RepSpec.vals0,false);
          end;
        EndFormat;
        Gray_Divider(tab[3],90);
        StartFormat(15);
        EndFormat;
      end;
      v["SaldoEndPeriod50n53USD"] = v["SaldoEndPeriod50USD"];
			v["SaldoEndPeriod50n53EUR"] = v["SaldoEndPeriod50EUR"];
			v["SaldoEndPeriod50n53AZN"] = v["SaldoEndPeriod50AZN"];
      if (jewlf) then begin
        v["SaldoEndPeriod50n53USD"] = v["SaldoEndPeriod50n53USD"] + v["SaldoEndPeriod53USD"];
        v["SaldoEndPeriod50n53EUR"] = v["SaldoEndPeriod50n53EUR"] + v["SaldoEndPeriod53EUR"];
        v["SaldoEndPeriod50n53AZN"] = v["SaldoEndPeriod50n53AZN"] + v["SaldoEndPeriod53AZN"];
      end;
      
			v["Balance52USD"] = 0;
      v["Balance52EUR"] = 0;
      v["Balance52AZN"] = 0;
      tempBal = 0;
      for (i=0;i<curi;i=i+1) begin
        if left(CurList[i],3)=="USD" then begin
          FindNLAccBal("52",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
          v["Balance52USD"] = v["Balance52USD"] + tempBal;
        end;
      end;
      tempBal = 0;
      for (i=0;i<curi;i=i+1) begin
        if left(CurList[i],3)=="EUR" then begin
          FindNLAccBal("52",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
          v["Balance52EUR"] = v["Balance52EUR"] + tempBal;
        end;
      end;
      tempBal = 0;
      for (i=0;i<curi;i=i+1) begin
        if left(CurList[i],3)=="AZN" then begin
          FindNLAccBal("52",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,CurList[i],0,"","",tempBal);
          v["Balance52AZN"] = v["Balance52AZN"] + tempBal;
        end;
      end;
      if ((v["Balance52USD"]!=0) or (v["Balance52EUR"]!=0)) then begin
        f = false;
        if (v["Balance52USD"]!=0) then begin
          if (!f) then begin
            StartFormat(15);
              OutString(tab[1],0,"",false);
              OutString(tab[2],0,"Остаток по расчетному счету в валюте:",false);
            EndFormat;
            f = true;
          end;
          StartFormat(15);
            OutString(tab[1],0,"",false);
            OutString(tab[3],0,"",false);
            OutString(tab[4],0,v["Balance52USD"],false);
            OutString(tab[5],0,"USD",false);
          EndFormat;
        end;
        if (v["Balance52EUR"]!=0) then begin
          if (!f) then begin
            StartFormat(15);
              OutString(tab[1],0,"",false);
              OutString(tab[2],0,"Остаток по расчетному счету в валюте:",false);
            EndFormat;
            f = true;
          end;
          StartFormat(15);
            OutString(tab[1],0,"",false);
            OutString(tab[3],0,"",false);
            OutString(tab[4],0,v["Balance52EUR"],false);
            OutString(tab[5],0,"EUR",false);
          EndFormat;
        end;
        if (v["Balance52AZN"]!=0) then begin
          if (!f) then begin
            StartFormat(15);
              OutString(tab[1],0,"",false);
              OutString(tab[2],0,"Остаток по расчетному счету в валюте:",false);
            EndFormat;
            f = true;
          end;
          StartFormat(15);
            OutString(tab[1],0,"",false);
            OutString(tab[3],0,"",false);
            OutString(tab[4],0,v["Balance52AZN"],false);
            OutString(tab[5],0,"AZN",false);
          EndFormat;
        end;
        if (f) then begin
          tempBal = 0;
          FindNLAccBal("52",RepSpec.ObjStr,"",0,"",AddDay(RepSpec.sEndDate,1),0,0,false,"",0,"","",tempBal);
          v["SaldoEndPeriod52"] = tempBal;
          Gray_Divider(tab[3],90);
          StartFormat(15);
            OutString(tab[1],0,"",false);
            OutString(tab[3],0,"Сумма в осн. вал.",false);
            OutString(tab[4],0,v["SaldoEndPeriod52"],false);
            OutString(tab[5],0,"AZN",false);
            if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
              OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
              OutMyString(160,0,v["SaldoEndPeriod52"]/RepSpec.vals0,false);
            end;
          EndFormat;
          Gray_Divider(tab[3],90);
          StartFormat(15);
            OutString(tab[1],0,"",false);
            OutString(tab[3],0,"Курсовая",false);
            OutString(tab[4],0,v["kursovaya52"],false);
            OutString(tab[5],0,"AZN",false);
            if(RepSpec.vals0!=0)then begin
              OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
              OutMyString(160,0,(v["kursovaya52"])/RepSpec.vals0,false);
            end;
          EndFormat;
          Gray_Divider(tab[3],90);
          StartFormat(15);
          EndFormat;
          v["SaldoEndPeriod50n51"] = v["SaldoEndPeriod50n51"] + v["SaldoEndPeriod52"];
        end;
      end;
      StartFormat(15);
				OutString(tab[1],0,"",false);
				OutString(tab[2],0,"Остаток общего счета",false);
				OutString(tab[4],0,v["SaldoEndPeriod50n53USD"],false);
				OutString(tab[5],0,"USD",false);
			EndFormat;
			StartFormat(15);
				OutString(tab[1],0,"",false);
				OutString(tab[2],0,"",false);
				OutString(tab[4],0,v["SaldoEndPeriod50n53EUR"],false);
				OutString(tab[5],0,"EUR",false);
			EndFormat;
			StartFormat(15);
				OutString(tab[1],0,"",false);
				OutString(tab[2],0,"",false);
				OutString(tab[4],0,v["SaldoEndPeriod50n53AZN"],false);
				OutString(tab[5],0,"AZN",false);
			EndFormat;
			StartFormat(15);
				OutString(tab[1],0,"",false);
				OutString(tab[2],0,"",false);
				OutString(tab[4],0,v["SaldoEndPeriod51"],false);
				OutString(tab[5],0,"AZN терминал",false);
			EndFormat;
      if (v["Balance52USD"]!=0) then begin
        StartFormat(15);
          OutString(tab[1],0,"",false);
          OutString(tab[2],0,"",false);
          OutString(tab[4],0,v["Balance52USD"],false);
          OutString(tab[5],0,"USD банк",false);
        EndFormat;
      end;
      if (v["Balance52EUR"]!=0) then begin
        StartFormat(15);
          OutString(tab[1],0,"",false);
          OutString(tab[2],0,"",false);
          OutString(tab[4],0,v["Balance52EUR"],false);
          OutString(tab[5],0,"EUR банк",false);
        EndFormat;
      end;
      if (v["Balance52AZN"]!=0) then begin
        StartFormat(15);
          OutString(tab[1],0,"",false);
          OutString(tab[2],0,"",false);
          OutString(tab[4],0,v["Balance52AZN"],false);
          OutString(tab[5],0,"AZN банк",false);
        EndFormat;
      end;
			Gray_Divider(tab[3],90);
			StartFormat(15);
				OutString(tab[1],0,"",false);
				OutString(tab[3],0,"Сумма в осн. вал.",false);
        if (jewlf) then begin
          OutString(tab[4],0,v["SaldoEndPeriod50n51"] + v["SaldoEndPeriod53"],false);
          OutString(tab[5],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
            OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
            OutMyString(160,0,(v["SaldoEndPeriod50n51"] + v["SaldoEndPeriod53"])/RepSpec.vals0,false);
          end;
        end else begin
          OutString(tab[4],0,v["SaldoEndPeriod50n51"],false);
          OutString(tab[5],0,"AZN",false);
          if(RepSpec.vals0!=0)then begin// Edit ************************** Wednesday, 24 February 2016 10:05:01
            OutString(110,0,"В USD по курсу: " & RepSpec.vals0,false);
            OutMyString(160,0,(v["SaldoEndPeriod50n51"])/RepSpec.vals0,false);
          end;
        end;
			EndFormat;
		end;
	EndJob;
	
	return;
end;
    