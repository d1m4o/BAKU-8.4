//server-onlyglobal procedure IdeaFinReportRn(record RcVc RepSpec)begin	record ORVc ORr;	row ORVc ORrw;	integer mtrw,i,j;	boolean TrHs,testf;	vector boolean vdesflag,vordsalesman;	array string 200 adescodes,arefpr,aprojcode,arequester,aclient,aprnum,aorddes;	array date aprdate,alastpaiddate;	array val aprcost,apaidamnt,abalamnt,abalpmnt;	array longint asernr;	record UServc USr;		StartReportNoHeaderJob("PR Financial Report by designers and date");		STARTFORMAT(15);			outstring(0,0,"PR Financial Report By Designers and Date",false);		EndFormat;		STARTFORMAT(15);			outstring(0,0,CurrentDate,false);			outstring(360,0,"Between",false);			outstring(400,0,RepSpec.sStartDate,false);			outstring(435,0,"And",false);			outstring(1,0,RepSpec.sEndDate,true);		EndFormat;		black_divider(0,1);		STARTFORMAT(15);			outstring(0,0,"Designer",false);			outstring(35,0,"Ref PR #",false);			outstring(70,0,"Proj. Code",false);			outstring(110,0,"Requester",false);			outstring(145,0,"Client No.",false);			outstring(185,0,"PR No.",false);			outstring(215,0,"PR Date",false);			outstring(245,0,"Proj. Cost",false);			outstring(280,0,"Paid Amount",false);			outstring(330,0,"Last Paid Date",false);			outstring(380,0,"Balance Amount",false);			outstring(1,0,"Balance Paid",true);		EndFormat;		gray_divider(0,1);				ORr.OrdDate = RepSpec.sStartDate;		TrHs = true;		while(loopkey("OrdDate",ORr,1,TrHs))begin			testf = true;			if(ORr.OrdDate>RepSpec.sEndDate)then begin TrHs = false;  end;						if(TrHs)then begin				vordsalesman[ORr.SerNr & ORr.SalesMan] = true;				aorddes[aorddes.length] = ORr.SalesMan;				asernr[asernr.length] = ORr.SerNr;				aprnum[aprnum.length] = ORr.CustOrdNr;				aprojcode[aprojcode.length] = ORr.AuthorizationCode;				arequester[arequester.length] = ORr.IDReguester;				aclient[aclient.length] = ORr.CustCode;				arefpr[arefpr.length] = ORr.RefStr;				aprdate[aprdate.length] = ORr.OrdDate;				aprcost[aprcost.length] = ORr.Sum4;				//apaidamnt[apaidamnt.length] = ORr.???				//alastpaiddate[alastpaiddate.length] = ORr.???				//abalamnt[abalamnt.length] = ORr.???				//abalpmnt[abalpmnt.length] = ORr.???								if(vdesflag[ORr.SalesMan]==false)then begin					vdesflag[ORr.SalesMan] = true;					adescodes[adescodes.length] = ORr.SalesMan;				end;			end;		end;		resetloop(ORr);				for(i=0;i<adescodes.length;i=i+1)begin			USr.Code = adescodes[i];			readfirstmain(USr,1,true);			STARTFORMAT(15);				outstring(0,0,USr.Name,false);			EndFormat;			for(j=0;j<asernr.length;j=j+1)begin				if(aorddes[j]==adescodes[i])then begin					STARTFORMAT(15);						outstring(0,0,"",false);						outstring(35,0,arefpr[j],false);						outstring(70,0,aprojcode[j],false);						outstring(110,0,arequester[j],false);						outstring(145,0,aclient[j],false);						outstring(185,0,aprnum[j],false);						outstring(215,0,aprdate[j],false);						outstring(245,0,aprcost[j],false);						outstring(280,0,"Paid Amount",false);						outstring(330,0,"Last Paid Date",false);						outstring(380,0,"Balance Amount",false);						outstring(1,0,"Balance Paid",true);					EndFormat;				end;			end;			gray_divider(0,1);		end;			endjob;return;end;